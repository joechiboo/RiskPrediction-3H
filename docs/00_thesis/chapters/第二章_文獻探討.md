# 第二章 文獻探討

## 2.1 研究動機

三高疾病（高血壓、高血糖、高血脂）是全球重要的公共衛生議題。根據世界心臟聯盟[^1]統計，心血管疾病每年造成約 2,000 萬人死亡，占全球死亡人數近三分之一，其中三高是主要的可控風險因子。在台灣，40 歲以上國人高血壓盛行率為 38.3%、高血脂盛行率為 34.1%、高血糖盛行率為 16.4%，顯示三高疾病影響相當廣泛[^2]。更令人關注的是三高年輕化趨勢：30 至 39 歲族群中已有 18.7% 有高血脂、9.7% 有高血壓、2.5% 有高血糖[^2]。為因應此趨勢，國民健康署自 2025 年起將成人預防保健服務年齡從 40 歲下修至 30 歲[^3]。此外，約有 4 至 7 成民眾不知道自己已罹患三高，凸顯早期預測與篩檢的重要性[^2]。

[^1]: World Heart Federation. (2023). World Heart Report 2023. https://world-heart-federation.org/world-heart-report-2023/
[^2]: 國民健康署（2022）。2017-2020 國民營養健康狀況變遷調查。衛生福利部。
[^3]: 國民健康署（2025）。成人預防保健服務擴大至 30 歲公告。衛生福利部。

傳統的三高風險評估多仰賴單一時間點的健檢數據，然而疾病的發展是一個漸進的過程。縱向健檢資料能夠捕捉生理指標隨時間的變化趨勢，提供比橫斷面資料更豐富的預測資訊。近年來，機器學習方法在疾病預測領域展現優異表現，但多數研究仍以單一疾病、單一時間點為主，缺乏對三高疾病的綜合性預測研究。

本研究旨在利用縱向健檢資料，建立能同時預測三高疾病風險的機器學習模型，並透過變化量特徵（Delta Features）捕捉生理指標的動態變化，提升預測效能與臨床實用性。

## 2.2 三高疾病預測研究

### 2.2.1 高血壓預測

高血壓定義為收縮壓 ≥ 140 mmHg 或舒張壓 ≥ 90 mmHg。Kanegae et al. (2020) 使用日本職場健檢資料（18,258 人）建立高血壓預測模型，採用 XGBoost 和 Ensemble 方法，達到 AUC 0.881。該研究的重要貢獻在於使用縱向變化量特徵（Year(-2) → Year(-1) → Year(0)），證明 Δ 特徵在高血壓預測上的有效性。

Wang et al. (2024) 使用台灣美兆（MJ）健檢資料進行大規模研究（207,488 人），發現健檢次數越多，預測準確度越高（4 次以上最佳），達到 AUC 0.889。此研究支持多時間點特徵串接的設計理念，與本研究的縱向設計概念一致。

### 2.2.2 高血糖與糖尿病預測

高血糖定義為空腹血糖 ≥ 126 mg/dL（7.0 mmol/L）。Liu et al. (2024) 使用台中榮總電子病歷（6,687 人，追蹤 10 年），以 XGBoost 達到 AUC 0.93，關鍵特徵包括 HbA1c、空腹血糖、體重等。

Chen et al. (2025) 同樣使用 MJ 健檢資料（6,247 位 18-35 歲男性），提出雙框架設計同時預測血糖變化量（δ-FPG）與前驅糖尿病風險。研究發現基線空腹血糖（FPGbase）對預測 δ-FPG 的重要性達 100%，遠超第二名體脂肪的 17.64%，顯示縱向血糖變化具有高度可預測性。本研究的 Δ 特徵設計即參考此概念。

### 2.2.3 高血脂預測

高血脂定義為總膽固醇 ≥ 240 mg/dL（6.2 mmol/L）或三酸甘油酯 ≥ 200 mg/dL（2.3 mmol/L）。相較於高血壓與糖尿病，高血脂的機器學習預測研究較少。多數研究將高血脂作為心血管疾病的風險因子，而非獨立的預測目標。本研究將高血脂納入三高同時預測的框架中，填補此研究缺口。

## 2.3 縱向資料分析與變化量特徵

### 2.3.1 縱向研究設計

縱向研究（Longitudinal Study）追蹤同一群體在不同時間點的變化，相較於橫斷面研究（Cross-sectional Study）具有以下優勢：

1. **捕捉動態變化**：能觀察生理指標隨時間的趨勢
2. **時序因果關係**：可建立預測因子與結果的時間順序
3. **個體內變異**：控制個體間差異，專注於個體內的變化

然而，縱向資料也面臨挑戰，包括追蹤期間的樣本流失、時間間隔不一致、以及缺失值處理等問題。

### 2.3.2 變化量特徵工程

變化量特徵（Delta Features）定義為兩個時間點之間生理指標的差值：

$$\delta_j = x_{j,Y_{-1}} - x_{j,Y_{-2}}$$

其中 $x_j$ 為第 j 個生理指標。Chen et al. (2025) 以 δ-FPG（空腹血糖變化量）作為預測目標，證明縱向變化量具有高度可預測性。Kanegae et al. (2020) 同樣使用 Δ 特徵預測高血壓，證明此方法的跨疾病適用性。

本研究採用八個變化量特徵：ΔSBP、ΔDBP、ΔFBG、ΔTC、ΔCr、ΔUA、ΔeGFR、ΔBMI，分別捕捉血壓、血糖、血脂、腎功能與身體質量指數的動態變化。

## 2.4 機器學習方法

### 2.4.1 傳統統計方法

Logistic Regression（邏輯斯迴歸）是疾病預測研究中最常用的基準模型，其優點在於係數可直接解釋為勝算比（Odds Ratio），便於臨床解讀。然而，LR 假設特徵與結果之間為線性關係，可能無法捕捉複雜的非線性模式。

### 2.4.2 樹狀模型

Decision Tree（決策樹）透過遞迴分割建立規則，具有高度可解釋性。Random Forest（隨機森林）是決策樹的集成方法，透過 Bagging 降低過擬合風險。XGBoost 採用梯度提升策略，在多項疾病預測競賽中表現優異。Alaa et al. (2019) 使用 AutoPrognosis 自動化機器學習預測心血管疾病，達到 AUC 0.774。Liu et al. (2024) 和 Chen et al. (2025) 皆報告 XGBoost 達到最佳預測效能。Dinh et al. (2019) 則使用 GBM 預測糖尿病並結合 SHAP 進行可解釋性分析，達到 AUC 0.834。

### 2.4.3 神經網路

多層感知器（MLP）可學習複雜的非線性關係，但面臨可解釋性不足與過擬合風險。Taiwan MTL (2025) 使用 Attention 機制進行多疾病預測，透過注意力分數提供一定程度的可解釋性。

### 2.4.4 符號回歸

符號回歸（Symbolic Regression）透過遺傳規劃演化出可解釋的數學公式。相較於黑盒模型，符號回歸產出的公式可直接理解其醫學意義。然而，符號回歸的搜尋過程具有隨機性，結果穩定性較低。

## 2.5 類別不平衡處理

三高疾病的發病率通常低於 20%，造成類別不平衡問題。常見的處理方法包括：

1. **重採樣方法**：SMOTE（Synthetic Minority Over-sampling Technique）生成合成少數類樣本
2. **成本敏感學習**：透過 class_weight 參數調整少數類的損失權重
3. **評估指標選擇**：使用 AUC-ROC 而非 Accuracy 作為主要評估指標，避免多數類偏誤

本研究採用 class_weight='balanced' 策略，並以 AUC 作為主要評估指標，同時報告 Sensitivity 和 Specificity 以反映臨床應用需求。

## 2.6 研究缺口與本研究定位

### 2.6.1 相關研究比較

表 2-1 比較本研究與相關文獻的差異。

**表 2-1 相關研究比較**

| 項目 | Alaa et al. (2019) | Dinh et al. (2019) | Kanegae et al. (2020) | Wang et al. (2024) | 本研究 |
|------|-------------------|-------------------|----------------------|-------------------|--------|
| 預測目標 | 心血管疾病 | 糖尿病 | 高血壓 | 高血壓 | 三高（同時） |
| 資料來源 | UK Biobank | NHANES | 日本職場健檢 | Taiwan MJ | 某醫療機構 |
| 樣本數 | 423,604 人 | 公開資料集 | 18,258 人 | 207,488 人 | 6,056 人 |
| 最佳模型 | AutoPrognosis | GBM | XGBoost | XGBoost | LR/XGBoost |
| 最佳 AUC | 0.774 | 0.834 | 0.881 | 0.889 | 0.721-0.938 |
| Δ 特徵 | 無 | 無 | 有 | 無 | 有 |
| 可解釋性 | 無 | SHAP | 特徵重要性 | 特徵重要性 | SHAP + 符號回歸 |
| 類別不平衡 | - | 有處理 | 有處理 | 有處理 | class_weight |

### 2.6.2 研究缺口

綜觀現有文獻，本研究識別以下研究缺口：

1. **多疾病同時預測**：多數研究僅針對單一疾病，缺乏三高疾病的綜合預測框架
2. **變化量特徵的系統性驗證**：雖然 Chen et al. (2025) 和 Kanegae et al. (2020) 證明 Δ 特徵有效，但僅針對單一疾病，缺乏跨疾病的驗證
3. **模型比較的完整性**：現有研究通常只比較少數模型，缺乏傳統統計、樹模型、神經網路、符號回歸的全面比較
4. **可解釋性與效能的平衡**：多數研究偏重預測效能，較少探討臨床可解釋性

### 2.6.3 本研究貢獻

本研究旨在填補上述缺口，主要貢獻包括：

1. **三高整合預測**：一次預測高血壓、高血糖、高血脂三種疾病
2. **長期預測**：提供 2-4 年的預警時間，優於短期預測
3. **Δ 特徵跨疾病驗證**：系統性驗證變化量特徵在三種疾病上的效果
4. **雙重可解釋性**：結合 SHAP 分析與符號回歸公式

## 2.7 問題定義

### 2.7.1 資料表示

本研究採用滑動窗口方法處理縱向健檢資料。每位患者若有 n 次健檢記錄，可生成 (n-2) 個訓練樣本：

```
患者健檢序列: 第1次(Y-4) → 第2次(Y-3) → 第3次(Y-2) → 第4次(Y-1) → 第5次(Y0)
                                              ↓
Window 1: (第1次, 第2次) → 第3次    即 (Y-4, Y-3) → Y-2
Window 2: (第2次, 第3次) → 第4次    即 (Y-3, Y-2) → Y-1
Window 3: (第3次, 第4次) → 第5次    即 (Y-2, Y-1) → Y0
```

每個窗口中，前兩次健檢作為輸入特徵（Y-2、Y-1），第三次健檢作為預測目標（Y0）。此設計可將 6,056 位患者擴增為 13,514 個訓練樣本。

### 2.7.2 特徵定義

輸入特徵向量定義為 26 維：

$$X = [X_{base}, X_{Y-2}, X_{Y-1}, \Delta X] \in \mathbb{R}^{26}$$

其中：
- $X_{base} \in \mathbb{R}^{2}$：基本資訊（Sex, Age）
- $X_{Y-2} \in \mathbb{R}^{8}$：Y-2 時間點的健檢指標
- $X_{Y-1} \in \mathbb{R}^{8}$：Y-1 時間點的健檢指標
- $\Delta X \in \mathbb{R}^{8}$：變化量特徵（Y-1 − Y-2）

### 2.7.3 預測任務

定義三個二元分類任務：

| 任務 | 預測目標 | 診斷標準 |
|------|----------|----------|
| 高血壓 | Y0 是否罹患高血壓 | SBP ≥ 140 或 DBP ≥ 90 mmHg |
| 高血糖 | Y0 是否罹患高血糖 | FBG ≥ 7.0 mmol/L |
| 高血脂 | Y0 是否罹患高血脂 | TC ≥ 6.2 或 TG ≥ 2.3 mmol/L |

### 2.7.4 評估指標

本研究採用以下評估指標：

| 指標 | 說明 |
|------|------|
| AUC-ROC | 主要評估指標，衡量模型區分能力 |
| Sensitivity | 正確識別患病者的比例 |
| Specificity | 正確識別健康者的比例 |
| F1-Score | 精確率與召回率的調和平均 |

交叉驗證採用 StratifiedGroupKFold，確保同一患者的所有樣本皆在同一 fold，避免資料洩漏。
