# Dual Framework 2025 - 台灣青年男性前驅糖尿病預測（深度解析）

## 📋 論文基本資訊

- **完整標題**：Dual Machine Learning Framework for Predicting Long-Term Glycemic Change and Prediabetes Risk in Young Taiwanese Men
- **中文標題**：用於預測台灣年輕男性長期血糖變化與前驅糖尿病風險的雙機器學習框架
- **期刊**：Diagnostics 2025, 15(19), 2507
- **期刊等級**：SCIE, IF 3.3 (2024), Q2
- **DOI**：[10.3390/diagnostics15192507](https://doi.org/10.3390/diagnostics15192507)
- **PDF位置**：[diagnostics-15-02507.pdf](../references/diagnostics-15-02507.pdf) (3.5 MB)
- **發表日期**：2025年10月2日
- **收稿日期**：2025年8月8日
- **修訂日期**：2025年9月28日
- **接受日期**：2025年9月28日
- **與本研究關聯度**：⭐⭐⭐⭐⭐ (最高)

---

## 👥 作者列表

### 第一作者
**楊仲棋** (Chung-Chi Yang) - t220979@gmail.com
1. 桃園國軍總醫院心血管內科
2. 三軍總醫院心血管科，國防醫學院
3. 國立清華大學醫學院
4. 國立清華大學生物資訊與結構生物研究所

### 共同作者

**吳聲堂** (Sheng-Tang Wu) - doc20283@gmail.com
5. 三軍總醫院泌尿科，國防醫學院
6. 高雄國軍總醫院泌尿科

**朱大維** (Ta-Wei Chu) - taweichu@gmail.com
7. 三軍總醫院婦產科，國防醫學院
8. MJ Health 研究基金會

### 通訊作者 ⭐

**劉紀豪** (Chi-Hao Liu) - colinliu1201@gmail.com ⭐
9. 高雄國軍總醫院腎臟科
10. 國防醫學院醫學系
- 電話：+886-7-749-6751

**莊永仁** (Yung-Jen Chuang) - yjchuang@life.nthu.edu.tw ⭐
3. 國立清華大學醫學院
4. 國立清華大學生物資訊與結構生物研究所
- 電話：+886-3-574-2764

---

## 📝 摘要（Abstract）完整翻譯

### 背景（Background）
年輕成人的血糖異常早期檢測非常重要但研究不足。本研究旨在：(1) 預測空腹血糖的長期變化 (δ-FPG)，以及 (2) 使用互補的機器學習方法對未來前驅糖尿病進行分類。

### 方法（Methods）
我們分析了 **6,247 名 18-35 歲台灣男性**的資料（平均追蹤 5.9 年）。

**連續結果 (δ-FPG)**：
- 比較隨機森林、隨機梯度提升 (SGB)、極端梯度提升 (XGBoost) 和彈性網路與多元線性迴歸
- 使用對稱平均絕對百分比誤差 (SMAPE)、均方根誤差 (RMSE)、相對絕對誤差 (RAE) 和相對均方根誤差 (RRSE) 評估
- 敏感性分析：排除基線 FPG (FPGbase)
- Shapley 加法解釋 (SHAP) 值提供可解釋性
- 通過 10 次重複訓練-測試循環評估穩定性，並提供信賴區間

**二元結果 (前驅糖尿病 vs. 正常)**：
- 使用前幾名預測因子訓練 XGBoost 分類器
- 使用 SMOTE-Tomek 校正類別不平衡
- 執行校準和決策曲線分析 (DCA)

### 結果（Results）
ML 模型在所有誤差指標上均優於迴歸。

**關鍵預測因子**：
- FPGbase 是主導預測因子（100% 重要性）
- 移除 FPGbase 後的關鍵預測因子：體脂肪、白血球計數、年齡、促甲狀腺激素、三酸甘油酯和低密度脂蛋白膽固醇

**前驅糖尿病分類器性能**：
- 準確度：0.788
- 精確度：0.791
- 敏感度：0.995
- ROC-AUC：0.667
- PR-AUC：0.873

**閾值性能**：
- 高敏感度閾值 (0.2892)：敏感度 99.53%、特異度 47.46%
- 平衡閾值 (0.5683)：敏感度 88.69%、特異度 90.61%

**校準與臨床效用**：
- 校準可接受（Brier 分數 0.1754）
- DCA 顯示臨床效用

### 結論（Conclusions）
FPGbase 是血糖變化最強的預測因子，但肥胖、發炎、甲狀腺功能和血脂仍具信息量。**雙可解釋 ML 框架為年輕男性的篩檢和風險分層提供臨床可操作的工具**。

### 關鍵詞（Keywords）
空腹血糖變化、台灣、機器學習、前驅糖尿病、年輕男性

---

## 🎯 研究亮點（核心創新）

### 1. 台灣本土大型縱向研究
- ✅ 樣本數：**6,247 人**
- ✅ 追蹤時間：平均 **5.9 年**
- ✅ 資料來源：**MJ Health 研究基金會**（台灣知名健檢中心）
- ✅ 目標族群：**18-35 歲年輕男性**
- ✅ 排除標準嚴格：排除服用影響血壓、血糖、血脂藥物者；排除基線血糖異常者

### 2. 創新的雙框架設計 ⭐⭐⭐⭐⭐
- ✅ **框架一**：δ-FPG 預測（連續值回歸）→ 追蹤血糖動態變化
- ✅ **框架二**：前驅糖尿病分類（二元分類）→ 對齊臨床診斷閾值
- ✅ 同時提供**量化風險**與**分類結果**
- ✅ 統計嚴謹性 + 臨床相關性

### 3. δ-FPG 特徵工程 ⭐⭐⭐⭐⭐
- ✅ **定義**：δ-FPG = FPG_follow-up - FPG_baseline
- ✅ **與本研究的 Δ 特徵概念完全一致**
- ✅ 血糖變化量作為預測指標
- ✅ 捕捉縱向動態變化
- ✅ **直接驗證變化量策略的有效性**

### 4. SHAP 可解釋性分析 ⭐⭐⭐⭐
- ✅ 提供每個特徵的重要性排序
- ✅ SHAP 蜂群圖（bee swarm plot）
- ✅ SHAP 依賴圖（dependence plot）
- ✅ 特徵交互作用視覺化
- ✅ 支持臨床決策解釋

### 5. 多模型比較與穩健驗證 ⭐⭐⭐⭐
- ✅ 比較 **4 種 ML 模型**：RF, SGB, XGBoost, Elastic Net
- ✅ **1 種傳統統計方法**：Multiple Linear Regression (MLR)
- ✅ **10 次重複訓練-測試循環**
- ✅ 提供 **95% 信賴區間 (CI)**
- ✅ 確保結果穩健性與可重複性

### 6. 雙閾值策略（臨床應用導向）
- ✅ **高敏感度閾值 (0.2892)**：適合篩檢（敏感度 99.53%）
- ✅ **平衡閾值 (0.5683)**：適合診斷（Youden's J = 0.7930）
- ✅ 決策曲線分析 (DCA)：評估淨臨床效益

---

## 🔬 研究設計詳解

### 資料來源
- **機構**：MJ Health Research Foundation（台灣 MJ 健康篩檢中心）
- **授權碼**：MJHRF2023007A
- **追蹤時間**：平均 5.9 ± 4.21 年
- **IRB 批准**：高雄國軍總醫院 (KAFGHIRB 112-006, 2023/6/21)
- **倫理**：次級資料分析，參與者已簽署一般同意書

### 參與者選擇流程

```
初始招募：47,666 名男性
         ↓
排除 22,533 人（年齡 <18 或 >35 歲）
         ↓
完整研究世代：25,133 人
         ↓
排除 16,780 人（服用影響血壓、血糖、血脂藥物）
         ↓
排除 2,106 人（基線血糖異常）
         ↓
最終建模世代：6,247 人
```

### 納入標準
1. **年齡**：18-35 歲
2. **性別**：男性
3. **基線無糖尿病或前驅糖尿病**
4. **至少有兩次健康檢查記錄**（baseline + follow-up）

### 排除標準
1. 年齡 < 18 歲或 > 35 歲
2. 使用已知影響血壓、血糖或血脂的藥物
3. 基線血糖異常

### 預測目標
1. **δ-FPG**（連續值）：FPG_follow-up - FPG_baseline
2. **前驅糖尿病**（二元分類）：依據 ADA 標準（FPG 100-125 mg/dL）

---

## 📊 基線特徵（n = 6,247）

### 連續變量（平均值 ± 標準誤）

| 變量 | 平均值 ± SE |
|------|-------------|
| **年齡（歲）** | 27.75 ± 5.11 |
| **追蹤年數** | 5.89 ± 4.21 |
| **體脂肪（%）** | 21.38 ± 5.50 |
| **白血球計數（×10³/µL）** | 6.23 ± 1.44 |
| **血紅素（×10⁶/µL）** | 15.43 ± 0.99 |
| **血小板（×10³/µL）** | 236.72 ± 49.57 |
| **基線空腹血糖（mg/dL）** | 92.01 ± 4.74 |
| **GPT（IU/L）** | 31.51 ± 47.78 |
| **GOT（IU/L）** | 24.13 ± 20.85 |
| **γ-GT（IU/L）** | 19.88 ± 16.96 |
| **LDH（IU/L）** | 287.87 ± 66.74 |
| **尿酸（mg/dL）** | 7.08 ± 1.40 |
| **肌酸酐（mg/dL）** | 1.08 ± 0.13 |
| **三酸甘油酯（mg/dL）** | 100.36 ± 60.99 |
| **HDL-C（mg/dL）** | 49.25 ± 11.87 |
| **LDL-C（mg/dL）** | 112.56 ± 31.15 |
| **鹼性磷酸酶（IU/L）** | 147.33 ± 47.38 |
| **TSH（IU/mL）** | 1.61 ± 1.66 |
| **CRP（mg/dL）** | 0.21 ± 0.40 |
| **飲酒面積** | 1.60 ± 7.29 |
| **運動面積** | 9.55 ± 9.03 |
| **δ-FPG（mg/dL）** | 5.21 ± 7.02 |

### 分類變量

| 變量 | n (%) |
|------|-------|
| **婚姻狀況** | |
| 單身 | 3957 (63.9%) *** |
| 已婚 | 2232 (36.1%) |
| **睡眠時數** | |
| 0-4 h/day | 24 (0.4%) |
| 4-6 h/day | 1054 (16.9%) |
| 6-8 h/day | 4745 (76.2%) |
| >8 h/day | 408 (6.5%) |
| **教育程度** | |
| 小學 | 3 (0.1%) |
| 國中 | 51 (0.8%) |
| 高中 | 1012 (16.2%) |
| 大專 | 1830 (29.3%) |
| 大學 | 2293 (36.8%) |
| 碩士以上 | 1031 (16.8%) |
| **收入水平（千美元/年）** | |
| 0 | 1232 (19.7%) * |
| 12.7/年 | 1029 (16.5%) |
| 12.7-25.3/年 | 2822 (45.2%) |
| 25.3-38.0/年 | 883 (14.1%) |
| 38.0-50.6/年 | 130 (2.1%) |
| 50.6-63.3/年 | 73 (1.2%) |
| >63.3/年 | 78 (1.2%) |

註：*** p < 0.001, * p < 0.05

---

## 🧪 方法學詳解

### 連續結果預測（δ-FPG）

#### 機器學習方法

| 方法 | 類型 | 用途 | 參考文獻 |
|------|------|------|----------|
| **Random Forest (RF)** | 集成學習 | 回歸 + 分類 | Breiman, 2001 [22] |
| **Stochastic Gradient Boosting (SGB)** | 梯度提升 | 回歸 + 分類 | Friedman, 2001 [23] |
| **XGBoost** | 極端梯度提升 | 回歸 + 分類 | Chen & Guestrin, 2016 [24] |
| **Elastic Net (EN)** | 正則化線性模型 | 回歸 | Zou & Hastie, 2005 [25] |
| **Multiple Linear Regression (MLR)** | 傳統統計 | 回歸（對照組） | - |

#### 性能指標

| 指標 | 公式 | 意義 |
|------|------|------|
| **SMAPE** | (1/n) Σ \|yi - ŷi\| / ((\|yi\| + \|ŷi\|)/2) × 100 | 對稱平均絕對百分比誤差 |
| **RAE** | √[Σ(yi-ŷi)² / Σ(yi-ȳi)²] | 相對絕對誤差 |
| **RRSE** | √[Σ(yi-ŷi)² / Σ(yi-ȳi)²] | 相對均方根誤差 |
| **RMSE** | √[(1/n) Σ(yi - ŷi)²] | 均方根誤差 |

#### 數據分割與驗證策略
- **訓練/測試分割**：80/20
- **超參數調整**：10 折交叉驗證 + 網格搜索
- **穩健性驗證**：10 次重複訓練-測試循環（不同隨機種子）
- **信賴區間**：95% CI（基於 Student's t-distribution）

#### 兩個模型設計

**模型 1（包含 FPGbase）**：
- 包含所有 25 個基線變量
- 目的：評估 FPGbase 的主導影響

**模型 2（排除 FPGbase）**：
- 排除 FPGbase
- 目的：發現次要但重要的預測因子
- 避免 FPGbase 的壓倒性影響掩蓋其他因子

### 二元結果預測（前驅糖尿病分類）

#### XGBoost 分類流程

**資料處理**：
1. **資料分割**：70/30 衍生/驗證
2. **特徵工程**：
   - 臨床相關比率：TG/HDL-C, LDL-C/HDL-C, 腰臀比
   - 對數轉換：TG, γ-GT, ALP
3. **缺失值插補**：中位數插補
4. **類別不平衡**：SMOTE-Tomek

**模型訓練**：
5. **特徵選擇**：排列重要性 → 保留前 20 個預測因子
6. **超參數調整**：Optuna + 3 折分層交叉驗證
   - 100 次試驗
   - 20 輪後早停
   - 固定隨機種子（42）

**防止資料洩漏措施**：
- ✅ 所有預處理步驟（插補、SMOTE-Tomek、特徵工程、特徵選擇）在交叉驗證期間**獨立應用於每個訓練折**
- ✅ 中位數僅從訓練折計算
- ✅ SMOTE-Tomek 僅應用於訓練折
- ✅ 特徵選擇僅使用訓練折訓練的模型

**性能評估**：
- 準確度、精確度、召回率、特異度、F1 分數
- ROC-AUC、PR-AUC（優先考慮，因類別不平衡）
- 混淆矩陣（閾值 0.50）

**校準評估**：
- **Brier 分數**：Brier = (1/n) Σ(p̂i - yi)²
  - p̂i：預測機率
  - yi：觀察結果（1=前驅糖尿病, 0=正常）
  - 越低越好（0 = 完美校準）
- **可靠性曲線**：10 個風險區間

**臨床效用評估**：
- **決策曲線分析 (DCA)**：
  - 量化使用模型指導臨床決策的淨效益
  - 比較「治療所有」vs.「不治療」策略
  - 閾值機率範圍：0.01-0.99

**雙閾值策略**：
1. **高敏感度閾值 (0.2892)**：
   - 優先最小化假陰性
   - 適合篩檢
2. **平衡閾值 (0.5683)**：
   - 最大化 Youden's J = (敏感度 + 特異度 − 1)
   - 適合診斷

### SHAP 可解釋性分析

**應用於隨機森林（模型 2，無 FPGbase）**：

1. **SHAP 蜂群圖（Bee Swarm Plot）**：
   - 顯示每個特徵對個體預測的影響分佈和方向
   - 紅色：高特徵值
   - 藍色：低特徵值

2. **平均絕對 SHAP 值**：
   - 特徵重要性的全局排名

3. **淨 SHAP 值**：
   - 平均正貢獻 - 平均負貢獻
   - 顯示單向 vs. 雙向影響

4. **SHAP 依賴圖（Dependence Plot）**：
   - 特徵交互作用
   - 例：追蹤間隔 (Yr-GAP) × FPGbase
   - 例：FPGbase × 體脂肪%

### 穩健性與敏感性分析

1. **消融分析**：
   - 移除前 3 個最重要特徵
   - ROC-AUC：0.6753 → 0.5588
   - 顯示模型依賴關鍵預測因子

2. **多重共線性評估**：
   - 計算所有預測因子的方差膨脹因子 (VIF)
   - 所有 VIF < 10（可接受）
   - 最大 VIF = 8.00（變量 x8）

3. **特徵相關性熱圖**（補充圖 S1）

### 可重現性工件

提供 **Python v3.10.12 腳本**（補充圖 S2）：
- 生成合成資料（n=100，模擬本研究結構）
- 訓練 XGBoost 迴歸器
- 計算 SHAP 值
- 計算 RMSE
- 可從通訊作者處獲得

---

## 📊 研究結果詳解

### 3.1 人口統計特徵分層分析

按追蹤結束時的血糖結果分層：

| 變量 | 前驅糖尿病組 (n=2789) | 正常組 (n=3458) | p 值 |
|------|---------------------|----------------|------|
| **年齡（歲）** | 28.4 ± 5.0 | 27.3 ± 5.1 | *** |
| **追蹤年數** | 5.6 ± 4.0 | 6.1 ± 4.4 | *** |
| **體脂肪（%）** | 22.1 ± 5.5 | 20.8 ± 5.5 | *** |
| **WBC（×10³/µL）** | 6.3 ± 1.5 | 6.2 ± 1.4 | *** |
| **基線 FPG（mg/dL）** | 93.3 ± 4.3 | 91.0 ± 4.8 | *** |
| **TG（mg/dL）** | 105.8 ± 66.1 | 96.0 ± 56.2 | *** |
| **LDL-C（mg/dL）** | 115.0 ± 32.0 | 110.6 ± 30.3 | *** |
| **HDL-C（mg/dL）** | 48.4 ± 11.6 | 50.0 ± 12.1 | *** |
| **δ-FPG（mg/dL）** | 9.88 ± 5.45 | 1.44 ± 5.77 | *** |

**關鍵差異**：
- 前驅糖尿病組年齡較大（28.4 vs. 27.3 歲）
- 體脂肪較高（22.1 vs. 20.8%）
- 基線 FPG 較高（93.3 vs. 91.0 mg/dL）
- δ-FPG 較高（9.88 vs. 1.44 mg/dL）

註：*** p < 0.001

### 3.2 連續結果預測（δ-FPG）性能

#### 模型 1（包含 FPGbase）

| 方法 | SMAPE | RAE | RRSE | RMSE |
|------|-------|-----|------|------|
| **MLR** | 0.968 | 0.9283 | 0.9077 | 6.4156 |
| **RF** | 0.9571 | 0.9273 | 0.9074 | 6.4133 |
| **SGB** | 0.9426 | 0.9306 | 0.9113 | 6.4407 |
| **XGBoost** | 0.9443 | 0.929 | 0.9102 | 6.4329 |
| **EN** | **0.9599** | **0.9266** | **0.9068** | **6.4092** ⭐ |

**結論**：
- ✅ 所有 ML 模型均優於 MLR
- ✅ **Elastic Net 表現最佳**（最低 RMSE 和 RRSE）
- ✅ RF 和 XGBoost 緊隨其後

#### 模型 2（排除 FPGbase）

| 方法 | SMAPE | RAE | RRSE | RMSE |
|------|-------|-----|------|------|
| **MLR** | 0.951 | 0.9845 | 0.9832 | 6.9022 |
| **RF** | 0.9477 | 0.9887 | 0.9854 | 6.9175 |
| **SGB** | **0.9489** | **0.9839** | **0.9817** | **6.8916** ⭐ |
| **XGBoost** | 0.9498 | 0.9878 | 0.985 | 6.9149 |
| **EN** | 0.9492 | 0.9845 | 0.9827 | **6.8985** |

**結論**：
- ✅ 如預期，移除 FPGbase 後性能略有下降
- ✅ **EN 和 SGB 表現最佳**
- ✅ 次要預測因子仍保留實質解釋價值

#### 可重複性驗證（10 次重複運行）

| 模型 | 指標 | 平均值 | SE | 95% CI 下限 | 95% CI 上限 |
|------|------|--------|-----|------------|------------|
| **EN** | RMSE | 6.427868 | 0.00196 | 6.423434 | 6.432301 |
| **RF** | RMSE | 6.471158 | 0.00179 | 6.467109 | 6.475208 |
| **XGBoost** | RMSE | 7.056346 | 0.002225 | 7.051313 | 7.06138 |

**結論**：
- ✅ **極窄的 95% CI**（通常上下界幾乎相同）
- ✅ **高度穩定**和**可重複**的模型性能

### 3.3 特徵重要性分析

#### 模型 1（包含 FPGbase）- 前 10 名

| 排名 | 變量 | MOIP（平均重要性%） |
|------|------|-------------------|
| 1 | **基線空腹血糖 (FPGbase)** | **100.00** ⭐ |
| 2 | 體脂肪 | 17.64 |
| 3 | 促甲狀腺激素 (TSH) | 14.80 |
| 4 | 白血球計數 (WBC) | 14.51 |
| 5 | 追蹤年數 | 14.32 |
| 6 | C 反應蛋白 (CRP) | 11.63 |
| 7 | 年齡 | 10.30 |
| 8 | HDL-C | 9.75 |
| 9 | 尿酸 | 9.34 |
| 10 | 血紅素 | 8.80 |

註：MOIP = 四種 ML 模型（RF, SGB, XGBoost, EN）的平均重要性百分比

**結論**：
- ⚠️ FPGbase 重要性 100%，遠超第二名（體脂肪 17.64%）
- ⚠️ FPGbase 的壓倒性影響掩蓋了其他臨床相關預測因子
- ✅ 因此需要模型 2 (排除 FPGbase) 來發現次要因子

#### 模型 2（排除 FPGbase）- 前 10 名

| 排名 | 變量 | MOIP（平均重要性%） | 臨床意義 |
|------|------|-------------------|----------|
| 1 | **體脂肪 (Body Fat %)** | **88.85** ⭐ | 肥胖標誌 - 持續促進血糖上升 |
| 2 | **白血球計數 (WBC)** | **58.62** ⭐ | 發炎標誌 - 與胰島素抗性相關 |
| 3 | **年齡 (Age)** | **54.89** ⭐ | 衰老標誌 - β 細胞功能下降 |
| 4 | **促甲狀腺激素 (TSH)** | **36.87** | 甲狀腺功能 - 代謝率降低 |
| 5 | **三酸甘油酯 (TG)** | **32.66** | 脂質異常 - 胰島素抗性 |
| 6 | **LDL-C** | **28.69** | 脂質異常 - 高 TG、高 LDL-C、低 HDL-C |
| 7 | HDL-C | 27.42 | 脂質異常 |
| 8 | 追蹤年數 | 24.94 | 時間因素 |
| 9 | γ-GT | 22.78 | 肝功能 |
| 10 | 血紅素 | 22.67 | 血液學 |

**結論**：
- ✅ 移除 FPGbase 後，**體脂肪、WBC、年齡**成為前三大預測因子
- ✅ 重要性分數重新分配，揭示了更廣泛的影響因子
- ✅ 涵蓋**肥胖、發炎、代謝、脂質**四大病理機制

### 3.4 SHAP 可解釋性分析（模型 2）

#### SHAP 蜂群圖關鍵發現

**全局重要性排序**：
1. 追蹤年數 (Years of follow-up)
2. 促甲狀腺激素 (TSH)
3. HDL-C
4. 年齡 (Age)
5. 乳酸脫氫酶 (LDH)
6. 體脂肪 (Body Fat)

**方向性影響**：
- **體脂肪**：高值（紅色）→ 正 SHAP 值 → 增加 δ-FPG（促進血糖上升）
- **HDL-C**：高值（紅色）→ 負 SHAP 值 → 減少 δ-FPG（保護作用）

#### SHAP 依賴圖：特徵交互作用

**圖 9：追蹤間隔 (Yr-GAP) × FPGbase**
- X 軸：追蹤年數
- Y 軸：SHAP 值
- 顏色：FPGbase

**發現**：
- 追蹤時間越長 → SHAP 值越高 → δ-FPG 增加
- **交互作用**：FPGbase 較低者，追蹤時間的影響更強

**圖 10：FPGbase × 體脂肪%**
- X 軸：FPGbase
- Y 軸：SHAP 值
- 顏色：體脂肪%

**發現**：
- **FPGbase 較低** → 強烈正 SHAP 值 → δ-FPG 增加
- **FPGbase 較高** → 負貢獻
- **調節作用**：體脂肪%（顏色梯度）進一步調節此關係

**臨床解釋**：
- 即使基線血糖正常，高體脂肪者仍有血糖上升風險
- 追蹤時間越長，血糖變化越明顯

### 3.5 二元分類結果（前驅糖尿病 vs. 正常）

#### 整體性能（閾值 0.50）

| 指標 | 數值 | 解釋 |
|------|------|------|
| **準確度 (Accuracy)** | 0.788 | 78.8% 正確分類 |
| **精確度 (Precision)** | 0.791 | 79.1% 預測為前驅糖尿病者確實是 |
| **敏感度 (Recall)** | **0.995** ⭐ | **幾乎找到所有前驅糖尿病患者** |
| **特異度 (Specificity)** | 0.010 | 僅 1% 正常者被正確識別 |
| **False Positive Rate** | 0.990 | 99% 正常者被誤判為前驅糖尿病 |
| **F1 Score** | 0.881 | 精確度與召回率的調和平均 |
| **ROC-AUC** | 0.667 | 中等區分能力 |
| **PR-AUC** | **0.873** ⭐ | **在不平衡資料集上表現良好** |

**混淆矩陣**（閾值 0.50）：

|              | 預測：正常 | 預測：前驅糖尿病 |
|--------------|----------|----------------|
| **實際：正常** | 4 (TN) | 390 (FP) |
| **實際：前驅糖尿病** | 8 (FN) | 1473 (TP) |

**解讀**：
- ✅ **極高敏感度（0.995）**：僅漏掉 8 個前驅糖尿病患者
- ⚠️ **極低特異度（0.010）**：390 個正常者被誤判
- ✅ **適合篩檢**：優先不漏診，假陽性可透過進一步檢查排除

#### 雙閾值策略

**高敏感度閾值（0.2892）- 篩檢用**

| 指標 | 數值 |
|------|------|
| 閾值 | 0.2892 |
| **敏感度** | **99.53%** ⭐ |
| 特異度 | 47.46% |

**適用場景**：
- ✅ 人群級篩檢
- ✅ 早期發現所有高風險個體
- ✅ 可接受較多假陽性

**平衡閾值（0.5683）- 診斷用**

| 指標 | 數值 |
|------|------|
| 閾值 | 0.5683 |
| 敏感度 | 88.69% |
| 特異度 | 90.61% |
| **Youden's J** | **0.7930** ⭐ |

**適用場景**：
- ✅ 確認性評估
- ✅ 針對性干預計畫
- ✅ 平衡敏感度與特異度

#### 校準與臨床效用

**Brier 分數**：0.1754
- 解釋：良好至中等校準
- 0 = 完美校準，1 = 最差

**可靠性曲線（圖 14）**：
- 預測機率與觀察結果在各區間良好對齊
- 高風險區（>0.6）：對齊極佳
- 低風險區：輕微低估

**決策曲線分析（圖 15）**：
- **RF 模型**在閾值機率 10%-80% 範圍內提供**最大淨效益**
- 優於「治療所有」和「不治療」策略
- **臨床效用最高**在中等風險範圍
- **結論**：支持作為針對性預防工具

#### 95% Bootstrap 信賴區間（補充表 S1）

| 指標 | 95% CI 下限 | 95% CI 上限 |
|------|------------|------------|
| **ROC-AUC** | 0.6697 | 0.6882 |
| **PR-AUC** | 0.6349 | 0.6630 |

---

## 💡 討論（Discussion）- 重點摘要

### 主要發現

1. **FPGbase 是最強預測因子**
   - 重要性：100%
   - 遠超第二名（體脂肪 17.6%）
   - 符合 Bogalusa Heart Study（21年追蹤）發現

2. **移除 FPGbase 後的關鍵因子**
   - **體脂肪（88.85%）**：肥胖與血糖調節受損的核心關係
   - **WBC（58.62%）**：慢性發炎與胰島素抗性
   - **年齡（54.89%）**：即使在年輕族群中也有影響
   - **TSH、TG、LDL-C**：甲狀腺功能與脂質異常

3. **連續與二元框架的互補性**
   - 連續模型：追蹤代謝軌跡
   - 二元模型：直接支持臨床篩檢
   - 預測因子重疊（體脂、TG、LDL-C、年齡）

### 臨床意義

1. **體脂肪（Body Fat）**
   - 參考：Jo et al., NHANES 研究
   - 發現：正常體重但高體脂者，血糖異常率高於體重過重但低體脂者
   - 本研究：證實體脂是年輕男性的核心風險因子

2. **白血球計數（WBC）**
   - 參考：Jiang et al., 中國研究；Ohshita et al., 日本研究
   - WBC 與前驅糖尿病顯著相關
   - 可能機制：肥胖相關的慢性發炎

3. **年齡（Age）**
   - 即使在 18-35 歲年輕族群中仍有可測量的影響
   - 機制：β 細胞質量減少、氧化壓力、DNA 修復受損

4. **促甲狀腺激素（TSH）**
   - 參考：Korzeniowska et al., 2019；Kim et al., 2022
   - TSH 與糖尿化合物和脂質代謝相關
   - 甲狀腺功能可能早期影響血糖

5. **脂質異常（TG、LDL-C）**
   - 胰島素抗性的標誌
   - 脂質與糖代謝相互依賴

### 研究優勢

1. **大型縱向世代**（6,247 人，5.9 年）
2. **雙 ML 框架**（連續 + 二元）
3. **SHAP 可解釋性**
4. **嚴格驗證**（10 次重複 + CI）
5. **臨床導向**（雙閾值策略 + DCA）

### 研究限制

1. **缺少關鍵生物標記**
   - 血漿胰島素
   - HbA1c
   - 限制了對胰島素抗性和 β 細胞功能的評估

2. **未測量的生活方式因子**
   - 詳細飲食攝入
   - 睡眠品質
   - 家族史
   - 可能存在殘餘混雜

3. **單一人群**
   - 僅台灣年輕男性
   - 限制對女性、老年人、其他族裔的推廣性

4. **外部驗證**
   - 雖有內部驗證（重複 CV + CI）
   - 但缺乏外部或時間驗證

---

## 🎯 結論（Conclusions）

### 核心發現

1. **FPGbase 是長期血糖變化最強預測因子**
   - 在台灣年輕男性中，基線血糖水平主導未來血糖變化

2. **移除 FPGbase 後，體脂肪、WBC、年齡、TSH、LDL-C、HDL-C 仍為關鍵決定因素**
   - 肥胖、發炎、甲狀腺功能和脂質仍具重要信息量

3. **雙框架設計提供互補視角**
   - **回歸模型**：捕捉微妙的血糖軌跡
   - **分類模型**：實現基於閾值的篩檢
   - 共同增強風險分層

4. **雙可解釋 ML 框架為年輕成人的篩檢和風險分層提供臨床可操作的工具**

### 臨床應用價值

- ✅ **早期篩檢**：高敏感度閾值（0.2892）
- ✅ **診斷確認**：平衡閾值（0.5683）
- ✅ **針對性預防**：識別可修改的風險因子（體脂、WBC、脂質）
- ✅ **臨床解釋**：SHAP 提供透明決策支持

---

## 🔗 與本研究的深度關聯分析

### ⭐⭐⭐⭐⭐ 極高關聯度總結

| 面向 | Dual Framework 2025 | 本研究 | 關聯度 | 可借鑑程度 |
|------|-------------------|--------|--------|-----------|
| **δ 特徵工程** | δ-FPG = FPG_follow-up - FPG_baseline | Δ 特徵（各指標變化量） | ⭐⭐⭐⭐⭐ | **直接驗證** |
| **雙框架設計** | 連續值 + 二元分類 | 可參考 | ⭐⭐⭐⭐⭐ | 設計思路 |
| **台灣健檢資料** | MJ Health | 台灣某健檢中心 | ⭐⭐⭐⭐ | 人口特性相似 |
| **縱向追蹤** | 5.9 年 | 三次健檢 | ⭐⭐⭐⭐ | 時間序列 |
| **SHAP 可解釋性** | SHAP 蜂群圖、依賴圖 | 可參考 | ⭐⭐⭐⭐ | 分析方法 |
| **多模型比較** | RF, SGB, XGBoost, EN, MLR | 可參考 | ⭐⭐⭐ | 穩健驗證 |
| **年輕族群** | 18-35 歲男性 | 健檢族群 | ⭐⭐ | 早期篩檢 |

### 直接可應用之處

#### 1. δ/Δ 特徵工程 ⭐⭐⭐⭐⭐
- **證據**：δ-FPG 重要性 100%，證實變化量策略有效
- **應用**：
  - 計算所有生理指標的 Δ 特徵（T2-T1, T3-T1, T3-T2）
  - 預期 Δ 特徵將成為最強預測因子
  - 驗證變化量比單一時間點更有預測力

#### 2. SHAP 可解釋性分析 ⭐⭐⭐⭐
- **可直接套用**：
  1. SHAP 蜂群圖（Bee Swarm Plot）
  2. 平均絕對 SHAP 值排序
  3. SHAP 依賴圖（特徵交互作用）
  4. 淨 SHAP 值（方向性影響）

- **視覺化模板**：
  ```python
  # 參考 Dual Framework 2025 的 SHAP 視覺化
  import shap

  # SHAP 蜂群圖
  shap.summary_plot(shap_values, X_test, plot_type="violin")

  # 特徵重要性
  shap.summary_plot(shap_values, X_test, plot_type="bar")

  # 依賴圖
  shap.dependence_plot("Body Fat", shap_values, X_test)
  ```

#### 3. 雙框架設計思路 ⭐⭐⭐⭐
- **框架一（連續值）**：
  - 預測 Δ 生理指標（如 Δ SUA、Δ BMI、Δ FPG）
  - 量化代謝變化軌跡

- **框架二（二元分類）**：
  - 分類疾病風險（高尿酸、代謝症候群、前驅糖尿病）
  - 對齊臨床診斷閾值

#### 4. 多模型比較與驗證 ⭐⭐⭐
- **策略**：
  - RF, XGBoost, LightGBM, SVM, Logistic Regression
  - 10 折交叉驗證
  - 計算 95% 信賴區間

- **性能指標**：
  - 連續值：RMSE, MAE, R²
  - 二元分類：Accuracy, Precision, Recall, F1, ROC-AUC, PR-AUC

#### 5. 雙閾值策略 ⭐⭐⭐
- **閾值 1（高敏感度）**：用於篩檢
- **閾值 2（平衡）**：用於診斷
- **決策曲線分析（DCA）**：評估臨床效用

### 需調整之處

#### 1. 預測目標不同
- **Dual Framework 2025**：前驅糖尿病
- **本研究**：高尿酸 / 代謝症候群 / 三高

#### 2. 輸入特徵差異
- **Dual Framework 2025**：單一時間點基線特徵
- **本研究**：三次健檢 + Δ 特徵

#### 3. 人口特性
- **Dual Framework 2025**：18-35 歲年輕男性
- **本研究**：健檢族群（年齡範圍更廣？）

---

## 📌 Meeting 17 重點討論議題

### 1. δ/Δ 特徵工程策略
**問題**：
- 本研究應如何計算和應用 Δ 特徵？
- 是否應優先使用 Δ 特徵作為主要預測因子？

**Dual Framework 2025 的證據**：
- δ-FPG 重要性 100%
- 證實變化量比單一時間點更有預測力

**建議行動**：
- ✅ 計算所有生理指標的 Δ 值（T2-T1, T3-T1, T3-T2）
- ✅ 比較 Δ 特徵 vs. 基線特徵的預測力
- ✅ 使用 SHAP 分析 Δ 特徵的重要性

### 2. 雙框架設計可行性
**問題**：
- 本研究是否應採用雙框架（連續值 + 二元分類）？
- 增加的模型複雜度是否值得？

**優點**：
- ✅ 提供更全面的風險評估
- ✅ 連續值：追蹤代謝軌跡
- ✅ 二元分類：對齊臨床診斷

**挑戰**：
- ⚠️ 增加建模工作量
- ⚠️ 需定義合適的診斷閾值

### 3. SHAP 可解釋性應用
**問題**：
- 如何在本研究中實作 SHAP？
- 視覺化圖表應如何設計？

**參考**：
- ✅ SHAP 蜂群圖（Bee Swarm Plot）
- ✅ 特徵重要性排序（Bar Plot）
- ✅ SHAP 依賴圖（Dependence Plot）
- ✅ 特徵交互作用分析

### 4. 關鍵預測因子比較
**Dual Framework 2025 的發現**：
- 體脂肪 (88.85%)
- WBC (58.62%)
- 年齡 (54.89%)
- TSH, TG, LDL-C

**本研究待分析**：
- 哪些特徵會成為最重要預測因子？
- Δ SUA 是否會像 δ-FPG 一樣成為主導因子？

### 5. 模型性能基準設定
**Dual Framework 2025 性能**：
- 敏感度：0.995（極高，適合篩檢）
- ROC-AUC：0.667
- PR-AUC：0.873

**問題**：
- 本研究應追求多高的敏感度？
- 如何平衡敏感度與特異度？
- 是否應採用雙閾值策略？

---

## 📚 後續工作規劃

### ✅ 已完成
- [x] 論文完整翻譯與深度解析
- [x] 與本研究的關聯分析
- [x] 可借鑑方法整理
- [x] Meeting 17 討論議題準備

### 📋 待完成（11/17 - 11/24）

#### 第一階段：特徵工程（11/17 - 11/18）
- [ ] 計算所有生理指標的 Δ 特徵
  - Δ = T2 - T1
  - Δ = T3 - T1
  - Δ = T3 - T2
- [ ] 驗證 Δ 特徵的預測力
- [ ] 比較 Δ 特徵 vs. 基線特徵

#### 第二階段：模型開發（11/19 - 11/21）
- [ ] 實作多種 ML 模型
  - Random Forest
  - XGBoost
  - LightGBM
  - SVM
- [ ] 超參數調整（Optuna + 10 折 CV）
- [ ] 計算 95% 信賴區間

#### 第三階段：可解釋性分析（11/22 - 11/23）
- [ ] 實作 SHAP 分析
  - SHAP 蜂群圖
  - 特徵重要性排序
  - SHAP 依賴圖
- [ ] 特徵交互作用分析
- [ ] 臨床解釋撰寫

#### 第四階段：結果整理（11/24）
- [ ] 製作視覺化圖表
  - 模型性能比較
  - SHAP 分析結果
  - 混淆矩陣、ROC 曲線、PR 曲線
- [ ] Meeting 17 簡報製作
- [ ] 初步結果文件撰寫

---

## 🔖 標籤

`#糖尿病預測` `#前驅糖尿病` `#δ特徵工程` `#Δ特徵` `#SHAP` `#可解釋性` `#台灣研究` `#MJ_Health` `#年輕族群` `#縱向研究` `#雙框架` `#機器學習` `#Random_Forest` `#XGBoost` `#決策曲線分析` `#Meeting17`

---

**文檔建立日期**：2025-11-13
**最後更新**：2025-11-13
**狀態**：✅ 完整翻譯與深度解析完成
**下一步**：實作 Δ 特徵計算與 SHAP 分析
