# Meeting 19 簡報

> **日期**：2026-01-14
> **內容**：Kanegae 2020 論文導讀 + 實驗成果報告

---

# Part 1: Kanegae 2020 論文導讀（Slide 1-10）

---

## Slide 1: 封面

### Highly Precise Risk Prediction Model for New-Onset Hypertension Using Artificial Intelligence Techniques

**使用人工智慧技術建立高精度新發高血壓風險預測模型**

- **Authors**: Kanegae H, Suzuki K, Fukatani K, Ito T, Harada N, Kario K
- **Institution**: Jichi Medical University, Japan
- **Journal**: J Clin Hypertens, 2020; 22(3): 445-450
- **Impact Factor**: 2.33 (Q2)
- **DOI**: 10.1111/jch.13759

---

**📝 講稿（1分鐘）**

> 各位好，今天要報告的論文是「Highly Precise Risk Prediction Model for New-Onset Hypertension Using Artificial Intelligence Techniques」，中文是「使用人工智慧技術建立高精度新發高血壓風險預測模型」。
>
> 這篇論文發表在 2020 年的 Journal of Clinical Hypertension，影響因子 2.33，屬於 Q2 期刊。作者來自日本自治醫科大學。
>
> 這篇論文與我們的研究高度相關，因為它也是使用健檢資料來預測高血壓，而且使用了「多時間點」和「變化量特徵」的方法，跟我們的研究設計非常相似。

---

## Slide 2: 研究背景

### 為什麼要預測高血壓？

| 問題 | 說明 |
|------|------|
| 臨床需求 | 高血壓是心血管疾病主要風險因子，全球約 10 億人受影響 |
| 研究空白 | 傳統統計方法難以捕捉複雜非線性關係 |
| 研究目標 | 用機器學習開發高精度預測模型 |

### 排除標準（重要）

| 排除條件 | 目的 |
|----------|------|
| 已有高血壓診斷 | 預測「新發」高血壓 |
| 正在使用降壓藥物 | 避免藥物干擾血壓值 |
| 數據缺失嚴重 | 資料品質 |

---

**📝 講稿（1分鐘）**

> 首先來看研究背景。高血壓是心血管疾病最重要的風險因子，全球約有 10 億人受到影響。傳統的統計方法難以捕捉複雜的非線性關係，所以這篇論文的目標是用機器學習來開發更精準的預測模型。
>
> 這裡要特別強調他們的排除標準：已有高血壓診斷的人、正在使用降壓藥物的人都被排除了。這樣做的目的是為了預測「新發」高血壓，而不是已知的高血壓患者。這點跟我們的研究有所不同，我們的資料集可能沒有藥物使用紀錄，這是一個限制。

---

## Slide 3: 研究設計

### 資料與時間軸

| 項目 | 內容 |
|------|------|
| 來源 | 日本職場健康檢查（CAVI 測量） |
| 時間 | 2005-2016 年（11 年） |
| 樣本數 | 18,258 人 |
| 新發高血壓 | 2,672 例 (14.6%) |

### 時間軸設計

```
Year(-2)     →     Year(-1)     →     Year(0)
   ↓                  ↓                  ↓
 特徵 1            特徵 2            預測目標
        \_________ Δ _________/
        Δ = Year(-1) − Year(-2)
```

---

**📝 講稿（1分鐘）**

> 資料來源是日本的職場健康檢查，特別的是他們使用了 CAVI（心踝血管指數）測量的資料。資料期間是 2005 到 2016 年，共 11 年，樣本數超過 1.8 萬人，其中新發高血壓有 2,672 例，佔 14.6%。
>
> 時間軸設計跟我們非常相似：用 Year(-2) 和 Year(-1) 的資料來預測 Year(0) 的高血壓狀態。這裡的命名方式我覺得比我們的 T1、T2、T3 更直覺，Year(0) 就是預測目標年，Year(-1) 是前一年。我們之後的論文也可以考慮採用這種命名方式。

---

## Slide 4: 核心創新 - Delta 特徵

### 使用縱向變化量作為特徵

| 類型 | 說明 | 例子 |
|------|------|------|
| Year(-2) 測量值 | 兩年前的數據 | SBP_Y-2 |
| Year(-1) 測量值 | 一年前的數據 | SBP_Y-1 |
| **變化量 (Δ)** | 兩年間的變化 | ΔSBP = SBP_Y-1 − SBP_Y-2 |

> **論文原文**：
> "The prediction model was constructed based on variables at Year(−1), Year(−2), and **changes** from Year(−2) to Year(−1)."

---

**📝 講稿（1分鐘）**

> 這篇論文的核心創新是使用「縱向變化量」作為特徵。他們不只用單一時間點的數據，還計算兩年間的變化量。
>
> 舉例來說，除了使用 Year(-2) 和 Year(-1) 的收縮壓，還會計算 ΔSBP，也就是血壓的變化量。這個設計跟我們的 Delta 特徵完全一致。
>
> 論文原文明確寫道：預測模型是基於 Year(-1)、Year(-2) 的變數，以及從 Year(-2) 到 Year(-1) 的「變化」來建構的。這驗證了我們使用 Delta 特徵的方法是有文獻依據的。

---

## Slide 5: 方法論

### 模型與評估

| 模型 | 類型 |
|------|------|
| XGBoost | 機器學習（梯度提升）|
| Ensemble | 機器學習（集成）|
| Logistic Regression | 傳統統計（基準）|

### 資料分割

- **訓練集**：75%
- **驗證集**：25%（內部驗證）

### 評估指標

- **AUC-ROC**：主要指標

---

**📝 講稿（1分鐘）**

> 在方法論上，他們比較了三種模型：XGBoost、Ensemble 集成模型，以及 Logistic Regression 作為基準。
>
> 資料分割採用 75% 訓練、25% 驗證的方式，這是內部驗證，沒有外部驗證。評估指標主要是 AUC-ROC。
>
> 跟我們的研究比較，我們用了更多種模型（LR、RF、XGBoost、SVM、MLP、DT），而且我們用 5-Fold CV 加上 GroupKFold 來防止資料洩漏，驗證策略更嚴謹。

---

## Slide 6: 結果 - 模型比較

### 機器學習優於傳統統計

| 模型 | AUC | 排名 |
|------|-----|------|
| **Ensemble** | **0.881** | 1 |
| XGBoost | 0.877 | 2 |
| Logistic Regression | 0.859 | 3 |

### 結論

- 機器學習比傳統統計 **+2.2%**
- 但差距不大，LR 也有 0.86 的 AUC

---

**📝 講稿（1分鐘）**

> 來看實驗結果。Ensemble 模型表現最好，AUC 達到 0.881；XGBoost 是 0.877；Logistic Regression 是 0.859。
>
> 機器學習比傳統統計大約高 2%，但其實差距不大。這跟我們的發現類似：在我們的實驗中，LR 在高血糖和高血脂的表現甚至比 RF 和 XGBoost 更好。這說明對於某些疾病預測，簡單的可解釋模型就已經足夠。

---

## Slide 7: 結果 - 特徵重要性

### 什麼因素最能預測高血壓？

| 排名 | 特徵 | 相對重要性 |
|------|------|-----------:|
| 1 | SBP at CAVI measurement, Year(-1) | **100%** |
| 2 | Clinic SBP, Year(-1) | 57.3% |
| 3 | BMI | 重要 |
| 4 | Age | 重要 |

### 結論

- **最近一年的血壓**是最強預測因子
- 符合臨床直覺

---

**📝 講稿（1分鐘）**

> 特徵重要性分析顯示，最重要的預測因子是 Year(-1) 的收縮壓，相對重要性是 100%。第二名是診所測量的收縮壓，大約 57%。BMI 和年齡也很重要。
>
> 這個結果符合臨床直覺：要預測一個人會不會得高血壓，最重要的當然是看他現在的血壓。這跟我們的 SHAP 分析結果一致：高血壓預測中，SBP 相關特徵排名最高。

---

## Slide 8: 臨床意義

### 預測 → 預防

1. **識別高風險個體**：在發病前預測
2. **早期介入**：生活方式改變（減重、運動、減鹽）
3. **個性化預防**：根據風險程度制定策略

### 應用場景

```
健檢報告：
  「根據您的健檢資料，未來一年發生高血壓的風險是 65%，
   建議減重 3 公斤、每週運動 3 次。」
```

---

**📝 講稿（1分鐘）**

> 這篇論文的臨床意義在於「預測」可以轉化為「預防」。透過識別高風險個體，可以在發病前進行早期介入，像是生活方式的改變：減重、運動、減鹽。
>
> 理想的應用場景是：健檢報告可以告訴病人「根據您的資料，未來一年發生高血壓的風險是 65%」，然後給出具體的建議。這就是預測模型的臨床價值。

---

## Slide 9: 研究限制

| 限制 | 說明 |
|------|------|
| 單一種族 | 僅日本人，需驗證其他種族 |
| 無外部驗證 | 只用內部 25% 驗證集 |
| 職場人群 | 可能無法推廣到一般人群 |
| 僅預測高血壓 | 未涵蓋其他慢性病 |

---

**📝 講稿（1分鐘）**

> 這篇論文也有一些限制。第一，只用日本人的資料，需要驗證是否適用於其他種族。第二，沒有外部驗證，只用內部的 25% 驗證集。第三，樣本是職場健檢人群，可能無法推廣到一般人群。第四，只預測高血壓一種疾病。
>
> 相比之下，我們的研究雖然也有限制，但我們同時預測三高，而且用了更嚴謹的 GroupKFold 驗證策略。

---

## Slide 10: 與我們研究的關聯

| 項目 | Kanegae 2020 | 我們的研究 |
|------|--------------|------------|
| 縱向設計 | Year(-2) → Year(-1) → Year(0) | Y-2 → Y-1 → Y0 |
| Δ 變化量 | ✅ | ✅ |
| 樣本數 | 18,258 人 | 6,056 人 |
| 預測目標 | 高血壓（1 種） | **三高（3 種）** |
| 外部驗證 | ❌ | ❌（Synthea 不適用） |
| 可解釋性 | 僅特徵重要性 | **SHAP + PySR 公式** |
| AUC（高血壓） | 0.877 | 0.743 |

### 引用價值

> 驗證我們使用「縱向變化量特徵」的方法是有文獻依據的！

---

**📝 講稿（1分鐘）**

> 最後來比較一下這篇論文和我們的研究。時間軸設計幾乎一樣，都用兩年的資料預測第三年。Delta 變化量特徵的設計也一樣。
>
> 他們的樣本數比我們多（1.8 萬 vs 6 千），AUC 也比我們高（0.877 vs 0.743）。但我們有一些優勢：我們同時預測三高，不只是高血壓；我們用 SHAP 和 PySR 做更深入的可解釋性分析。
>
> 這篇論文的引用價值在於：它驗證了我們使用「縱向變化量特徵」的方法是有文獻依據的，這對我們的論文 Related Work 章節很有幫助。

---

# Part 2: 實驗成果報告（Slide 11-20）

---

## Slide 11: Problem Definition

### 數學定義

**輸入**：
$$X = [X_{base}, X_{Y-2}, X_{Y-1}, \Delta X]$$

- $X_{base}$：性別、年齡
- $X_{Y-2}, X_{Y-1}$：兩次健檢指標
- $\Delta X = X_{Y-1} - X_{Y-2}$：變化量

**輸出**：
$$\hat{Y} = [\hat{y}_{高血壓}, \hat{y}_{高血糖}, \hat{y}_{高血脂}] \in [0,1]^3$$

---

**📝 講稿（1分鐘）**

> 接下來報告我們的實驗成果。首先是問題定義。
>
> 輸入是四個部分：基本資料（性別、年齡）、Y-2 的健檢指標、Y-1 的健檢指標，以及變化量 Delta X。
>
> 輸出是三個疾病的風險機率：高血壓、高血糖、高血脂，每個都是 0 到 1 之間的數值。這個設計跟 Kanegae 2020 類似，但我們同時預測三種疾病。

---

## Slide 12: 5-Fold CV 最終結果

### StratifiedGroupKFold（防止資料洩漏）

| 疾病 | 最佳模型 | AUC | 95% CI |
|------|----------|----:|--------|
| 高血壓 | RF | 0.743 | (0.725, 0.762) |
| 高血糖 | LR | 0.938 | (0.924, 0.951) |
| 高血脂 | LR | 0.867 | (0.850, 0.884) |

### 資料

- 滑動窗口：13,514 筆
- 患者數：6,056 人

---

**📝 講稿（1分鐘）**

> 這是我們的主要結果。使用 StratifiedGroupKFold 做 5-Fold 交叉驗證，確保同一個病人的資料不會同時出現在訓練集和測試集，防止資料洩漏。
>
> 高血壓最佳模型是 Random Forest，AUC 0.743。高血糖和高血脂最佳模型都是 Logistic Regression，AUC 分別是 0.938 和 0.867。
>
> 高血糖的 AUC 特別高，接近 0.94，這是因為空腹血糖本身就是很強的預測因子。

---

## Slide 13: 模型比較

| 模型 | 高血壓 | 高血糖 | 高血脂 | 特點 |
|------|-------:|-------:|-------:|------|
| LR | 0.729 | **0.938** | **0.867** | 可解釋 |
| RF | **0.743** | 0.932 | 0.861 | 穩定 |
| XGBoost | 0.737 | 0.929 | 0.858 | 快速 |
| SVM | 0.725 | 0.933 | 0.857 | - |
| MLP | 0.720 | 0.925 | 0.852 | - |
| DT | 0.658 | 0.835 | 0.744 | 最差 |

### 結論

- LR 在 2/3 疾病表現最佳
- 複雜模型不一定比簡單模型好

---

**📝 講稿（1分鐘）**

> 這是所有模型的比較。可以看到 Logistic Regression 在高血糖和高血脂都是最佳，只有高血壓是 Random Forest 最好。
>
> Decision Tree 表現最差，這是因為單一決策樹容易過擬合。其他模型的差距都不大，大約在 1-2% 以內。
>
> 重要的結論是：複雜的黑盒模型不一定比簡單的可解釋模型好。這對臨床應用很重要，因為可解釋性在醫療領域非常關鍵。

---

## Slide 14: 健檢次數實驗（H1）

### 假說：健檢次數越多，預測越準

| 健檢次數 | 高血壓 | 高血糖 | 高血脂 |
|----------|-------:|-------:|-------:|
| 1 次 | 0.666 | 0.931 | 0.867 |
| 4 次 | **0.835** | **0.945** | 0.882 |
| **差異** | **+0.169** | +0.014 | +0.015 |

### 結論

- ✅ **已驗證**
- 高血壓受益最大（+17%）
- 高血糖 1 次健檢就很準（0.931）

---

**📝 講稿（1分鐘）**

> 假說 H1：健檢次數越多，預測越準。這跟 Kanegae 2020 和 Taiwan MJ 論文的發現一致。
>
> 結果顯示：高血壓從 1 次健檢的 0.666 提升到 4 次的 0.835，提升了 17%，受益最大。高血糖和高血脂的提升比較小，因為它們用 1 次健檢就已經很準了。
>
> 這說明縱向資料對高血壓預測特別有價值，因為血壓的變化趨勢是重要的預測因子。

---

## Slide 15: Delta 特徵消融（H2）

### 假說：變化量特徵能提升效能

| 疾病 | 無 Delta | 有 Delta | 提升 |
|------|------:|------:|-----:|
| 高血壓 | 0.695 | 0.743 | **+7%** |
| 高血糖 | 0.920 | 0.938 | +2% |
| 高血脂 | 0.850 | 0.867 | +2% |

### 結論

- ✅ **已驗證**
- Delta 特徵對高血壓貢獻最大
- 這驗證了 Kanegae 2020 的設計是有效的

---

**📝 講稿（1分鐘）**

> 假說 H2：Delta 變化量特徵能提升效能。這是驗證 Kanegae 2020 設計的關鍵實驗。
>
> 消融實驗顯示：移除 Delta 特徵後，高血壓 AUC 從 0.743 降到 0.695，下降了 7%。高血糖和高血脂的下降比較小，約 2%。
>
> 這證明 Delta 特徵確實有價值，特別是對高血壓。這也驗證了 Kanegae 2020 使用變化量特徵的設計是有效的。

---

## Slide 16: MTL vs STL（H3）

### 假說：多任務學習優於單任務學習

| 方法 | 高血壓 | 高血糖 | 高血脂 | 平均 | 時間 |
|------|-------:|-------:|-------:|-----:|-----:|
| MTL | 0.734 | 0.932 | 0.868 | 0.845 | 9.0 秒 |
| STL | 0.742 | 0.933 | 0.869 | 0.848 | 10.9 秒 |
| **差異** | -0.008 | -0.001 | -0.001 | -0.003 | 1.2x 快 |

### 結論

- ❌ **未驗證**
- 三高相關性弱（Phi < 0.1）
- 時間優勢有限（1.2x，非理論 3x）
- 這是**有價值的負面結果**

---

**📝 講稿（1分鐘）**

> 假說 H3：多任務學習優於單任務學習。我們原本假設同時預測三高可以讓模型學到共享的特徵表示。
>
> 結果顯示：MTL 和 STL 的效能幾乎一樣，差異不到 1%。進一步分析發現，三高之間的 Phi 相關係數都小於 0.1，相關性很弱。
>
> 這是一個負面結果，但也是有價值的發現：它說明三高雖然都是代謝疾病，但在預測上是相對獨立的任務。

---

## Slide 17: SHAP 可解釋性分析

### 各疾病由核心指標主導

| 疾病 | Top 3 特徵 |
|------|------------|
| 高血壓 | SBP_Y-1, SBP_Y-2, ΔSBP |
| 高血糖 | FBG_Y-1, FBG_Y-2, ΔFBG |
| 高血脂 | TC_Y-1, TC_Y-2, Age |

### 結論

- 模型學到**臨床合理**的特徵關係
- 血壓預測血壓、血糖預測血糖、膽固醇預測血脂
- 符合醫學直覺

---

**📝 講稿（1分鐘）**

> SHAP 分析顯示各疾病由核心指標主導。高血壓的前三名特徵都是血壓相關：SBP_Y-1、SBP_Y-2、ΔSBP。高血糖是血糖相關特徵。高血脂是膽固醇和年齡。
>
> 這個結果非常重要，因為它證明模型學到的是臨床合理的關係，不是在學一些奇怪的 pattern。血壓預測血壓、血糖預測血糖，完全符合醫學直覺。

---

## Slide 18: PySR 可解釋公式（H6）

### 符號回歸產生數學公式

| 疾病 | 公式 | AUC | 穩定性 |
|------|------|----:|--------|
| 高血壓 | 不穩定（常退化為常數） | ~0.58 | ❌ |
| 高血糖 | `0.12 × FBG_Y-1` | 0.918 | ✅ |
| 高血脂 | 不穩定 | ~0.64 | ❌ |

### 結論

- ✅ **部分驗證**
- 高血糖公式穩定且有臨床意義
- 高血壓/高血脂 PySR 搜索不穩定

---

**📝 講稿（1分鐘）**

> 假說 H6：符號回歸能找到有意義的數學公式。我們用 PySR 來嘗試。
>
> 結果是部分成功：高血糖產生了穩定的公式「0.12 乘以 FBG_Y-1」，AUC 達到 0.918，非常接近 LR 的效能。這個公式很直覺：血糖越高，風險越高。
>
> 但高血壓和高血脂的 PySR 搜索不穩定，常常退化為常數解。這可能是因為這兩種疾病的預測需要更複雜的特徵組合。

---

## Slide 19: 輸出：機率 vs 二元

### 兩種輸出的用途

```
模型 → predict_proba() → 機率 (0~1)
                ↓
        閾值 (threshold)
                ↓
            是/否 (0/1)
```

| 輸出 | 用途 | 指標 |
|------|------|------|
| 機率 | 風險排序、決策參考 | AUC |
| 二元 | 篩檢、分類 | Sensitivity, Specificity |

---

**📝 講稿（1分鐘）**

> 最後談一下模型輸出。模型可以輸出機率值（0 到 1），也可以設定閾值轉換成二元分類（是或否）。
>
> 機率輸出適合用於風險排序和決策參考，評估指標是 AUC。二元輸出適合用於篩檢和分類，評估指標是 Sensitivity 和 Specificity。
>
> 我們的實驗主要報告 AUC，因為它不受閾值選擇的影響，更能反映模型的整體區分能力。

---

## Slide 20: 假說驗證總結

| ID | 假說 | 結果 |
|----|------|:----:|
| H1 | 健檢次數越多越準 | ✅ |
| H2 | Delta 特徵有價值 | ✅ |
| H3 | MTL 優於 STL | ❌ |
| H4 | LR 效能接近黑盒 | ✅ |
| H5 | balanced 提升 Sensitivity | ✅ |
| H6 | PySR 找到有意義公式 | ⚠️ 部分 |

### 驗證率：4.5/6（75%）

---

**📝 講稿（1分鐘）**

> 總結一下假說驗證的結果。六個假說中，H1 健檢次數、H2 Delta 特徵、H4 LR 效能、H5 class_weight 都已驗證。H3 MTL 未驗證，但這是有價值的負面結果。H6 PySR 是部分驗證，高血糖成功但其他兩個不穩定。
>
> 整體驗證率大約 75%。這些結果為我們的論文提供了紮實的實證基礎。
>
> 以上是我的報告，謝謝大家。

---

## 附錄：參考資料

**論文**：
- Kanegae H, et al. J Clin Hypertens. 2020;22:445-450.
- DOI: [10.1111/jch.13759](https://doi.org/10.1111/jch.13759)

**Notebooks**：
- 17_SlidingWindow_5FoldCV.ipynb（主要結果）
- 19_SHAP_SlidingWindow.ipynb（SHAP）
- 21_Delta_Ablation.ipynb（消融）
- 23_PySR_SlidingWindow.ipynb（PySR）
- 25_PySR_Depth_Experiment.ipynb（PySR 深度實驗）

**命名對照**：
- T1 → Y-2（兩年前）
- T2 → Y-1（一年前）
- T3 → Y0（預測目標）
