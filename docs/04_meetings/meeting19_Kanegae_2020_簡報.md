# Meeting 19 簡報

> **日期**：2026-01-13
> **內容**：Kanegae 2020 論文導讀 + 實驗成果報告

---

# Part 1: Kanegae 2020 論文導讀（Slide 1-10）

---

## Slide 1: 封面

**論文導讀：使用 AI 技術預測新發高血壓**

- 作者：Kanegae H, Suzuki K, Fukatani K, Ito T, Harada N, Kario K
- 機構：日本自治醫科大學
- 期刊：J Clin Hypertens, 2020
- DOI：10.1111/jch.13759

---

## Slide 2: 研究背景

**為什麼要預測高血壓？**

| 問題 | 說明 |
|------|------|
| 臨床需求 | 高血壓是心血管疾病主要風險因子，全球約 10 億人受影響 |
| 研究空白 | 傳統統計方法難以捕捉複雜非線性關係 |
| 研究目標 | 用機器學習開發高精度預測模型 |

---

## Slide 3: 研究設計

**資料與時間軸**

| 項目 | 內容 |
|------|------|
| 來源 | 日本職場健康檢查 |
| 時間 | 2005-2016 年 |
| 樣本數 | 18,258 人 |
| 新發高血壓 | 2,672 例 (14.6%) |

**時間軸**：
```
Year(-2)  →  Year(-1)  →  Year(0)
   ↓            ↓            ↓
 特徵 1       特徵 2       預測目標
       \______Δ______/
         變化量特徵
```

---

## Slide 4: 核心創新 - Delta 特徵

**使用縱向變化量作為特徵**

| 類型 | 說明 | 例子 |
|------|------|------|
| Year(-2) 測量值 | 兩年前的數據 | SBP_Year(-2) |
| Year(-1) 測量值 | 一年前的數據 | SBP_Year(-1) |
| **變化量 (Δ)** | 兩年間的變化 | ΔSBP = SBP(-1) - SBP(-2) |

> 論文原文："The prediction model was constructed based on variables at Year(−1), Year(−2), and **changes** from Year(−2) to Year(−1)."

---

## Slide 5: 方法論

**模型與評估**

| 模型 | 類型 |
|------|------|
| XGBoost | 機器學習 |
| Ensemble | 機器學習（集成）|
| Logistic Regression | 傳統統計（基準）|

**資料分割**：75% 訓練 / 25% 驗證

**評估指標**：AUC-ROC

---

## Slide 6: 結果 - 模型比較

**機器學習優於傳統統計**

| 模型 | AUC | 排名 |
|------|-----|------|
| **Ensemble** | **0.881** | 1 |
| XGBoost | 0.877 | 2 |
| Logistic Regression | 0.859 | 3 |

**結論**：機器學習比傳統統計 **+2.2%**

---

## Slide 7: 結果 - 特徵重要性

**什麼因素最能預測高血壓？**

| 排名 | 特徵 | 相對重要性 |
|------|------|-----------:|
| 1 | Year(-1) SBP | 100% |
| 2 | Year(-1) 診所 SBP | 57.3% |
| 3 | BMI | 重要 |
| 4 | Age | 重要 |

**結論**：最近一年的血壓是最強預測因子

---

## Slide 8: 臨床意義

**預測 → 預防**

1. **識別高風險個體**：在發病前預測
2. **早期介入**：生活方式改變（減重、運動、減鹽）
3. **個性化預防**：根據風險程度制定策略

---

## Slide 9: 研究限制

| 限制 | 說明 |
|------|------|
| 單一種族 | 僅日本人，需驗證其他種族 |
| 無外部驗證 | 只用內部 25% 驗證集 |
| 職場人群 | 可能無法推廣到一般人群 |

---

## Slide 10: 與我們研究的關聯

| 項目 | Kanegae 2020 | 我們的研究 |
|------|--------------|-----------:|
| 縱向設計 | Year(-2) → Year(-1) → Year(0) | T1 → T2 → T3 |
| Δ 變化量 | ✅ | ✅ |
| 預測目標 | 高血壓（1 種） | **三高（3 種）** |
| 外部驗證 | ❌ | ✅ Synthea |
| 可解釋性 | 僅特徵重要性 | **SHAP + PySR** |

**引用價值**：驗證我們使用「縱向變化量特徵」的方法是有效的！

---

# Part 2: 實驗成果報告（Slide 11-20）

---

## Slide 11: Problem Definition

**數學定義**

**輸入**：
$$X = [X_{base}, X_{T_1}, X_{T_2}, \Delta X]$$

- $X_{base}$：性別、年齡
- $X_{T_1}, X_{T_2}$：兩次健檢指標
- $\Delta X = X_{T_2} - X_{T_1}$：變化量

**輸出**：
$$\hat{Y} = [\hat{y}_{HTN}, \hat{y}_{HG}, \hat{y}_{DL}] \in [0,1]^3$$

---

## Slide 12: 5-Fold CV 最終結果

**StratifiedGroupKFold（防止資料洩漏）**

| 疾病 | 最佳模型 | AUC | 95% CI |
|------|----------|----:|--------|
| 高血壓 | RF | 0.743 | (0.725, 0.762) |
| 高血糖 | LR | 0.938 | (0.924, 0.951) |
| 高血脂 | LR | 0.867 | (0.850, 0.884) |

**資料**：滑動窗口 13,514 筆

---

## Slide 13: 模型比較（含 PySR）

| 模型 | HTN | HG | DL | 特點 |
|------|----:|---:|---:|------|
| LR | 0.729 | **0.938** | **0.867** | 可解釋 |
| RF | **0.743** | 0.932 | 0.861 | 穩定 |
| XGBoost | 0.737 | 0.929 | 0.858 | 快速 |
| SVM | 0.725 | 0.933 | 0.857 | - |
| MLP | 0.720 | 0.925 | 0.852 | - |
| DT | 0.658 | 0.835 | 0.744 | 最差 |
| **PySR** | ~0.78 | ~0.91 | ~0.82 | **公式** |

---

## Slide 14: 健檢次數實驗（H1）

**假說：健檢次數越多，預測越準**

| 健檢次數 | HTN | HG | DL |
|----------|----:|---:|---:|
| 1 次 | 0.666 | 0.931 | 0.867 |
| 4 次 | **0.835** | **0.945** | 0.882 |
| **差異** | **+0.169** | +0.014 | +0.015 |

**結論**：✅ 確認，高血壓受益最大

---

## Slide 15: Delta 特徵消融（H2）

**假說：變化量特徵能提升效能**

| 疾病 | 無 Delta | 有 Delta | 提升 |
|------|------:|------:|-----:|
| 高血壓 | 0.695 | 0.743 | **+7%** |
| 高血糖 | 0.920 | 0.938 | +2% |
| 高血脂 | 0.850 | 0.867 | +2% |

**結論**：✅ 確認，Delta 特徵有價值（特別是高血壓）

---

## Slide 16: MTL vs STL（H3）

**假說：多任務學習優於單任務學習**

| 方法 | HTN | HG | DL | 平均 |
|------|----:|---:|---:|-----:|
| MTL | 0.734 | 0.932 | 0.868 | 0.845 |
| STL | 0.742 | 0.933 | 0.869 | 0.848 |
| **差異** | -0.008 | -0.001 | -0.001 | -0.003 |

**結論**：❌ 未驗證，三高相關性弱（Phi < 0.1）

→ **有價值的負面結果**

---

## Slide 17: SHAP 可解釋性分析

**各疾病由核心指標主導**

| 疾病 | Top 3 特徵 |
|------|------------|
| 高血壓 | SBP_T1, SBP_T2, Delta_SBP |
| 高血糖 | FBG_T2, FBG_T1, Delta_FBG |
| 高血脂 | TC_T2, TC_T1, Age |

**結論**：模型學到臨床合理的特徵關係

---

## Slide 18: PySR 可解釋公式（H6）

**符號回歸產生數學公式**

| 疾病 | 公式 | AUC |
|------|------|----:|
| 高血壓 | `abs((|Δ_SBP| + SBP_T1 + 1.46) * 0.15)` | 0.780 |
| 高血糖 | `0.12 * FBG_T2` | 0.910 |
| 高血脂 | `0.04 * exp(TC_T1)` | 0.815 |

**結論**：✅ 公式有臨床可解釋性

---

## Slide 19: 輸出：機率 vs 二元

**兩種輸出的用途**

```
模型 → predict_proba() → 機率 (0~1)
                ↓
        閾值 (threshold)
                ↓
            是/否 (0/1)
```

| 輸出 | 用途 | 指標 |
|------|------|------|
| 機率 | 風險排序、決策參考 | AUC |
| 二元 | 篩檢、分類 | Sensitivity, Specificity |

---

## Slide 20: 假說驗證總結

| ID | 假說 | 結果 |
|----|------|:----:|
| H1 | 健檢次數越多越準 | ✅ |
| H2 | Delta 特徵有價值 | ✅ |
| H3 | MTL 優於 STL | ❌ |
| H4 | LR 效能接近黑盒 | ✅ |
| H5 | balanced 提升 Sensitivity | ✅ |
| H6 | PySR 找到有意義公式 | ✅ |

**驗證率**：5/6（83%）

---

## 附錄：參考資料

**論文**：
- Kanegae H, et al. J Clin Hypertens. 2020;22:445-450.
- DOI: [10.1111/jch.13759](https://doi.org/10.1111/jch.13759)

**Notebooks**：
- 17_SlidingWindow_5FoldCV.ipynb（主要結果）
- 19_SHAP_SlidingWindow.ipynb（SHAP）
- 21_Delta_Ablation.ipynb（消融）
- 23_PySR_SlidingWindow.ipynb（PySR）
