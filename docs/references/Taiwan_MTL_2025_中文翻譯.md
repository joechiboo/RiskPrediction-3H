# Taiwan MTL (2025) 論文中文翻譯

**原文標題**: Multitask learning multimodal network for chronic disease prediction
**期刊**: Scientific Reports (2025年5月)
**作者**: Hsinhan Tsai et al., National Taiwan University
**DOI**: https://doi.org/10.1038/s41598-025-99554-z

---

## 摘要 (Abstract)

慢性疾病是老年人健康管理的重點。早期疾病預測在實現疾病預防和減少個人及醫療照護系統的相關負擔方面扮演著至關重要的角色。傳統上，預測不同疾病需要使用獨立的模型，這個過程需要大量的時間和計算資源。在本研究中，我們利用全國性資料集，提出了一種結合多模態疾病預測模型的多任務學習方法。透過利用患者的醫療紀錄和個人資訊作為輸入，該模型可以同時預測糖尿病、心臟病、中風和高血壓的風險。這種方法透過捕捉這些疾病之間的相關性來解決傳統方法的限制，同時即使在特徵數量減少的情況下也能保持強大的預測效能。此外，我們對注意力分數的分析識別出與先前研究一致的風險因子，增強了模型的可解釋性，並展示了其在實際應用中的潛力。

**關鍵詞**: ICD code embedding（ICD 代碼嵌入）、Chronic disease（慢性疾病）、Disease incidence prediction（疾病發生率預測）、Multi-task learning（多任務學習）、Multimodal network（多模態網路）

---

## 引言 (Introduction)

隨著醫療標準的提升和生活方式的改變，全球人口正在迅速老化。在台灣，慢性疾病已成為老年醫療照護的重大挑戰。本研究從患者和保險公司兩個角度探討慢性疾病帶來的挑戰。

### 從患者角度

慢性疾病可能導致嚴重的健康併發症。研究顯示，老年人和患有心臟病、糖尿病或呼吸道疾病等既有病症的人，在面對病毒感染等新的健康威脅時更容易出現嚴重後果。此外，慢性疾病對個人和社會造成重大經濟負擔。早期預測可以幫助預防或減輕這些疾病的影響，使其成為醫療照護管理的關鍵面向。

### 從保險公司角度

許多人購買保險以減輕與慢性疾病相關的財務風險。然而，準確評估被保險人的健康風險既耗時又耗資源，影響保險流程的效率。因此，預測未來疾病的可能性對於優化風險評估和資源配置至關重要。

### 台灣慢性疾病現況

在台灣，糖尿病、心臟病、中風和高血壓是最普遍的慢性疾病，其病因複雜且相互關聯。醫學文獻將風險因子分為：
- **不可修改因素**：年齡、性別、地理區域、遺傳
- **可修改因素**：高血脂、代謝症候群及其他相關病症

近年來，多項研究使用機器學習（ML）和深度學習（DL）提出慢性疾病預測模型。這些研究主要專注於預測單一慢性疾病，並展示了良好的準確性。然而，現有模型往往未能考慮多種慢性疾病之間的相互關係，且需要大量訓練時間和計算資源。

鑑於慢性病之間的強相關性——例如馬德里 14 歲或以上人口中近 25% 患有多種慢性疾病，西班牙的多重慢性病盛行率高達 30%——有很大的改進空間。

### 本研究創新

本研究引入了一個多任務學習（MTL）框架，透過利用患者的醫療紀錄來同時預測多種慢性疾病。與先前依賴生活方式和生物醫學特徵的研究不同，我們的方法專注於探索疾病之間的交互作用，同時考慮時序資訊，這對於識別可修改的風險因子和共病關係至關重要。

來自台灣的全國性資料集驗證了所提出方法的穩健性。此外，注意力分數分析突出了關鍵風險因子和共病關係，與文獻中的發現一致。這些結果強調了糖尿病、心臟病、中風和高血壓之間的強相互連結和共同風險因子，強調了 MTL 模型的有效性。

---

## 相關研究 (Related Work)

在我們的研究中，我們建立在失智症多模態注意力網路（MAND）的基礎上，並將其擴展以同時預測糖尿病、心臟病、中風和高血壓的風險。我們專注於使用患者醫療紀錄捕捉時序交互作用並探索共病關係。

### 主要技術方法

1. **ICD Code Embedding（ICD 代碼嵌入）**
   - 將國際疾病分類（ICD）代碼轉換為嵌入向量
   - 使用基於 Word2Vec 的 ICD 嵌入層

2. **Multi-Head Self-Attention（多頭自注意力機制）**
   - 用於捕捉疾病之間的交互作用

3. **Multi-Task Learning（多任務學習）**
   - 同時預測所有四種疾病以探索共病關係

4. **CTR 預測模型**
   - 從醫療紀錄預測疾病風險與點擊率（CTR）預測問題有相似之處
   - 探索單任務和多任務 CTR 模型用於慢性疾病預測的可行性

### 慢性疾病預測研究

多項研究已將 ML 和 DL 技術應用於慢性疾病預測：

**單一疾病預測**：
- 集成學習結合 ML 和 DL 模型的優勢
- 有效捕捉包含人口統計和實驗室資訊的資料集中的特徵和交互作用
- 預測心血管疾病和糖尿病
- **限制**：主要專注於單一疾病預測，未考慮慢性疾病之間的共病關係

**多疾病預測**：
近期研究越來越關注使用 MTL 開發能夠同時預測多種病症的模型：

- **MTL 方法 1**：基於生活方式、生化特徵和環境因子聯合預測糖尿病和高血壓
- **MTL 方法 2**：同時預測高血壓和糖尿病
  - 電子病歷首先轉換為嵌入向量
  - 共享卷積層捕捉共同資訊
  - 任務特定卷積層提取疾病特定特徵

**研究發現**：MTL 模型可以達到與針對特定疾病優化的單任務學習（STL）模型相當的預測效能。換句話說，高血壓和糖尿病之間的強相關性表明，聯合建模這些疾病可能導致更全面和有效的預測模型。

**現有研究的不足**：這些研究未考慮過去的醫療狀況和時序交互作用如何影響慢性疾病的發展。

### 點擊率預測 (CTR)

點擊率（CTR）預測是推薦系統中廣泛研究的主題。CTR 模型分析客戶資料（如瀏覽和購買歷史）以預測客戶未來點擊廣告的可能性。

**主要模型**：
- **因子分解機（FMs）**：在捕捉特徵交互作用方面特別有效
- **基於 FM 的模型**：DeepFM、xDeepFM
- **基於神經網路的模型**：深度交叉網路（DCN）及其擴展 DCNV2

**與本研究的關聯**：
本研究從 CTR 預測的核心概念獲得靈感：學習特徵之間的交互作用。在我們的情境中，患者醫療紀錄類似於客戶瀏覽歷史。透過學習疾病之間的交互作用，模型預測患者未來疾病發生的風險。這種方法已在預測失智症方面顯示出令人印象深刻的結果。

### 多任務學習 (Multi-Task Learning)

多任務學習的目標是同時學習多個任務，利用共享表示來增強跨任務的泛化能力。

**MTL 實作方法**：

1. **Hard Parameter Sharing（硬參數共享）**
   - 在任務之間共享隱藏層
   - 能夠學習共享表示
   - 共享隱藏層的權重根據所有任務的影響進行更新
   - 顯著降低過度擬合的風險

2. **Soft Parameter Sharing（軟參數共享）**
   - 每個任務有自己的獨立模型和參數
   - 與單任務學習不同，在訓練期間對每個模型參數之間的差異施加約束
   - 常用技術：L2 範數（歐幾里德距離）或跡範數

**MTL 的挑戰**：
雖然 MTL 可以減輕過度擬合，但當任務之間關係薄弱或衝突時，容易出現負遷移。這個問題被稱為「蹺蹺板現象」，指的是一個任務的改進導致另一個任務效能下降的反效果。

**本研究的優勢**：
在本研究中，我們將糖尿病、心臟病、中風和高血壓的風險預測視為不同的任務。幸運的是，這些任務表現出強相互關係：
- 糖尿病增加心臟病和中風的風險
- 高血壓和中風密切相關
- 糖尿病患者容易出現心臟病和中風等併發症

這些相關性表明我們的任務是良好對齊的，防止了薄弱任務關係和蹺蹺板現象的發生。

### 失智症多模態注意力網路 (MAND)

失智症多模態注意力網路（MAND）框架使用過去 10 年的醫療紀錄和個人資訊，預測患者在 5 年內發展失智症的可能性。

**MAND 特徵**：
- 醫療紀錄包括由 ICD 代碼表示的疾病歷史
- MAND 在 10 年內每 2 個月選擇最常出現的 5 種疾病
- 生成 300 個疾病相關特徵，捕捉疾病歷史和時序模式
- ICD 代碼使用預訓練的基於 Word2Vec 的 ICD 嵌入層轉換為嵌入向量

**特徵提取模組**：
為了模擬這些嵌入之間的交互作用，MAND 整合了多個特徵提取模組：
- MLP（多層感知器）
- LSTM（長短期記憶網路）
- CNN（卷積神經網路）
- MHSA（多頭自注意力機制）

**效能**：
該模型達到強大的預測效能，並透過注意力分數分析識別潛在風險因子。

**本研究的改進**：
在我們的工作中，我們調整 MAND 框架來預測糖尿病、心臟病、中風和高血壓。此外，我們將 MAND 擴展為 MTL 框架，同時預測這四種慢性疾病。我們的注意力分數分析也擴展到不僅調查關鍵風險因子，還調查疾病共病關係。

---

## 資料集與方法 (Dataset and Methodology)

### 問題定義

我們利用患者過去 10 年的醫療紀錄以及個人資訊，預測他們在未來 5 年內發展糖尿病、心臟病、中風或高血壓的風險。這個問題類似於文獻中描述的失智症預測問題。

### 資料集

**資料來源**：
資料回顧性收集自台灣健康與福利資料科學中心（HWDC），該中心為學術研究目的提供 200 萬人的隨機抽樣醫療紀錄。

**倫理審查**：
- 研究獲得國立台灣大學研究倫理委員會批准（NTU-REC No.: 202108HM002），批准日期：2021 年 8 月 9 日
- 由於研究的回顧性性質，國立台灣大學研究倫理委員會豁免了知情同意
- 研究按照《赫爾辛基宣言》中概述的倫理指南進行

**研究焦點**：
使用過去 10 年的個人資訊和醫療紀錄預測 5 年內糖尿病、心臟病、中風和高血壓的發生率。

**資料提取**：
- 從「Registry for Beneficiaries」檔案提取患者個人資訊
- 從「Ambulatory Care Expenditures」檔案提取醫療紀錄
- 患者年齡從 ID_BIRTH_Y 欄位計算
- 醫療紀錄使用 ICD_CM 欄位識別，該欄位包含診斷病症的 ICD 代碼
- 相應的就診時間從 FEE_YM 欄位衍生

**特徵建構**：
- 在過去 10 年中每 2 個月選擇最常出現的 3 種疾病
- 特徵長度：3 × 6 × 10 = 180
- 缺失值用 `<PAD>` token 替換
- 排除在前 10 年內被診斷患有任何目標疾病的患者

**最終資料集**：
- 總樣本數：555,124
- 疾病發生率：
  - 糖尿病：22.4%
  - 心臟病：24.6%
  - 中風：8.7%
  - 高血壓：39.0%
- 陰性案例比例（未發展任何四種疾病的患者）：51.3%

#### 受益人登記資料 (Registry for Beneficiaries)

此資料庫中儲存的個人資訊欄位描述如下：

- **ID**：每個人的唯一識別碼，作為資料庫合併的主鍵
- **ID_BIRTH_Y**：患者出生年份，也用作資料庫合併的鍵
- **ID_S**：患者性別
- **HOME_CITY**：患者居住地區代碼，提供詳細的區域資訊
- **REMOTE_MARK**：患者是否居住在偏遠地區的指標，捕捉更廣泛的區域資訊
- **ID_IDENT**：患者職業類別

#### 門診照護支出 (Ambulatory Care Expenditures)

此資料庫中儲存的醫療紀錄欄位描述如下：

- **ID**：每個人的唯一識別碼，作為資料庫合併的主鍵
- **AGE**：患者接受醫療治療時的年齡，既用作資料庫合併的鍵，也作為模型輸入的一部分
- **FEE_YM**：患者接受醫療治療的年月
- **ICD_CM**：與患者當前就診相關的診斷代碼

### 模型架構

在本研究中，我們使用三個模型來實現疾病預測的目標：

1. **預訓練 ICD Word2Vec 模型**：用於 ICD 嵌入
2. **單任務學習（STL）疾病預測模型**：為預測特定疾病而設計
3. **多任務學習（MTL）疾病預測模型**：本研究提出的主要創新

#### 預訓練 ICD Word2Vec 模型

此模型旨在將 ICD 代碼轉換為潛在空間中的嵌入向量，將相似疾病的嵌入向量分組以改進表示。

**訓練方法**：
- 在我們的資料集中，在 2 個月間隔內為患者診斷的所有 ICD 代碼被視為一個句子
- 出現在同一間隔的 ICD 代碼被視為正例
- 來自不同間隔的 ICD 代碼被視為負例
- 應用 skip-gram 模型到 ICD 語料庫
- 使用負採樣來降低計算複雜度
- 這些技術允許模型自動生成高品質的 ICD 嵌入向量，同時最小化參數複雜度

#### 單任務學習疾病預測模型

本研究採用 6 個 STL 模型進行疾病預測：
- 4 個具有不同 ICD 提取模組的多模態模型
- 2 個 CTR 模型

**多模態模型（MAND）變體**：
- **MAND-LR**：整合邏輯回歸（LR）作為 ICD 提取模組
- **MAND-MLP**：整合多層感知器（MLP）
- **MAND-LSTM**：整合長短期記憶網路（LSTM）
- **MAND-MHSA**：整合多頭自注意力機制（MHSA）

**CTR 模型**：
- **FM**：基於 FM 的方法代表
- **DCN**：基於神經網路的方法代表

**模型輸入分為三類**：
1. 由 ICD 代碼序列表示的醫療紀錄
2. 從個人資訊衍生的數值特徵
3. 個人資訊的類別特徵

#### 多任務學習疾病預測模型

我們將單疾病預測模型擴展為 MTL 模型。

**MTL 多模態網路架構**：
- 採用硬參數共享
- 串接層以上的所有參數都是共享的
- 這種方法顯著減少了參數數量
- 使 ICD 提取模組學習的潛在表示能夠同時捕捉糖尿病、心臟病、中風和高血壓之間的關係

**擴展 CTR 模型以支援 MTL**：
- 相對簡單
- 透過分別共享 FM 層輸出和串接輸出來構建 MTL CTR 模型

---

## 實驗結果 (Results)

### 實驗設定

**資料分割**：
- 555,124 個樣本分為訓練、驗證和測試集
- 比例：0.64（訓練）、0.16（驗證）、0.2（測試）
- 每個樣本包含 180 個 ICD 代碼，每 3 個 ICD 代碼代表一個 2 個月間隔

**資料預處理**：
- 數值特徵標準化
- 類別特徵標籤編碼
- ICD 代碼分詞化
- 預訓練 ICD 嵌入層：使用餘弦相似度測量特徵空間中 ICD 嵌入之間的距離

**模型超參數**：
- **MLP 模組**：兩個隱藏層，256 和 128 個神經元
- **MHSA**：頭數 = 1，鍵維度 = 16，值維度 = 8
- **FM 模型**：FM 層維度 = 8
- **DCN 模型**：兩個隱藏層，各 32 個神經元，使用 ReLU 激活函數
- **優化器**：Adam
- **損失函數**：Log loss
- **早停策略**：監控驗證集上的 AUC 值，如果 5 個 epoch 內沒有改進則停止訓練

**評估指標**：
- Log loss
- AUC（曲線下面積）
- BAC（平衡準確率）
- F1 score
- FPR（假陽性率）
- FNR（假陰性率）

### 資料視覺化

**編碼方式比較**：

傳統上，one-hot 編碼用於類別表示；然而，由於 ICD 代碼數量龐大，可能導致記憶體限制。

**編碼方法**：
1. **One-hot 編碼**：維度 = n（ICD 代碼總數）
2. **Label 編碼**：維度 = 1（每個 ICD 代碼分配唯一整數值）
3. **Multi-hot 編碼**：維度 = ⌈log₂ n⌉
4. **Word2Vec 嵌入**：維度 = 8（本實驗）

**視覺化技術**：
使用 t-SNE（t-分佈隨機鄰居嵌入）將高維度資料映射到低維度空間。在我們的研究中，t-SNE 將每個 ICD 代碼表示為二維點，相似疾病位置較近，不相關疾病以高機率映射得較遠。

**視覺化結果**（圖 3-6）：

**心臟病範例**（圖 3）：
- **(a) Label 編碼**：無法區分有無心臟病的患者
- **(b) Multi-hot 編碼**：顯著改進，心臟病患者（橙色）更集中在右側
- **(c) Word2Vec ICD 嵌入**：
  - 優越的聚類效果
  - 無心臟病患者（藍色）形成大型明顯的簇
  - 有心臟病患者（橙色）形成另一個清晰定義的簇

**其他疾病**（糖尿病、中風、高血壓）：
可以觀察到類似的模式

**結論**：
ICD 嵌入有效捕捉不同 ICD 代碼之間的關係，提供疾病的穩健表示。

### 效能比較：單任務學習 vs 多任務學習

**整體觀察**：
- STL 和 MTL 方法在所有四種疾病上都達到高 AUC 分數
- 多模態架構（為失智症預測開發）也可以有效預測慢性疾病
- 原為推薦系統設計的 CTR 模型可以適應疾病預測

**主要發現**：

1. **MTL 可與 STL 媲美甚至更優**
   - 常見假設：STL 設定了 MTL 效能的上限
   - 觀察：某些 MTL 結果優於 STL 結果
   - 暗示：這四種慢性疾病之間可能存在共享資訊或多重慢性病

2. **最佳模型：MAND-LSTM**
   - 無論 STL 或 MTL，都達到最佳 AUC 結果
   - 強調從 ICD 代碼序列提取的時序資訊的重要性

**各疾病效能**（MAND-LSTM）：

| 疾病 | STL AUC | MTL AUC |
|------|---------|---------|
| 心臟病 | 0.8774 | 0.8787 |
| 糖尿病 | 0.8926 | 0.8912 |
| 中風 | 0.8700 | 0.8625 |
| 高血壓 | 0.9346 | 0.9346 |

**挑戰**：

**高假陰性率（FNR）問題**：
- 在心臟病、糖尿病和中風預測中觀察到高 FNR
- 表明模型傾向於更頻繁地預測陰性案例
- **原因**：資料不平衡
  - 心臟病發生率：24.6%
  - 糖尿病發生率：22.4%
  - 中風發生率：8.7%（最低，對應最高 FNR）

### 參數數量比較：STL vs MTL

MTL 方法的另一個優勢是能夠同時預測多種疾病，同時與 STL 模型相比只需要少量額外參數。

**參數數量比較**（表 5）：

| 模型 | 單一 STL | 4 個 STLs | MTL |
|------|----------|-----------|-----|
| MAND-LR | 178,782 | 715,128 | 178,860 |
| MAND-MLP | 402,117 | 1,608,468 | 419,784 |
| MAND-LSTM | 187,333 | 749,332 | 195,784 |
| MAND-MHSA | 181,445 | 725,780 | 187,208 |
| FM | 402,345 | 1,609,380 | 402,385 |
| DCN | 416,441 | 1,665,764 | 421,196 |

**關鍵觀察**：
- 雖然 MTL 模型由於疾病特定預測層而需要比單一 STL 模型稍多的參數
- 共享的共同層可能有助於發現共病關係，這在臨床研究中至關重要
- **STL 模型預測四種疾病需要單一 STL 模型 4 倍的參數**
- 在計算和儲存資源方面要求顯著更高

**實際應用優勢**：

1. **資源受限環境**：
   - 在受限邊緣設備上部署 4 個獨立 STL 模型需要大量儲存空間
   - MTL 模型只需要約 1/4 的容量

2. **延遲問題**：
   - 載入多個 STL 模型的開銷可能引入延遲問題
   - 使即時預測變得不可行

**結論**：
這些發現突出了 MTL 在計算效率和儲存優化方面的優勢，使其成為實際臨床應用（如臨床決策支援）的實用選擇。

### 特徵重要性

**實驗目的**：
- 分別評估醫療紀錄和個人資訊的重要性
- 評估模型的穩健性
- 確定結果是否與醫學文獻的發現一致

#### 醫療紀錄重要性

**實驗方法**：
- 隨機遮蔽一定比例的醫療紀錄
- 檢查當醫療紀錄部分或完全缺失時，模型是否能保持預測能力
- 使用的 ICD 提取模組：LSTM
- 用 `<PAD>` token 替換來遮蔽醫療紀錄
- 效能透過對四個任務的指標進行平均來計算

**結果**（表 6）：

| 遮蔽率 | Log Loss | AUC |
|--------|----------|-----|
| 0%（完整） | 0.2829 | 0.8918 |
| 10% | 0.2838 | 0.8911 |
| 20% | 0.2857 | 0.8900 |
| 30% | 0.2898 | 0.8878 |
| 40% | 0.2933 | 0.8863 |
| 50% | 0.2946 | 0.8856 |
| 60% | 0.3009 | 0.8825 |
| 70% | 0.3113 | 0.8785 |
| 80% | 0.3211 | 0.8752 |
| 90% | 0.3845 | 0.8577 |
| 100%（僅個人資訊） | 0.5348 | 0.8031 |

**關鍵發現**：

1. **醫療紀錄至關重要**：
   - 使用完整醫療紀錄：AUC = 0.8918
   - 完全遮蔽醫療紀錄：AUC = 0.8031
   - 包含完整醫療紀錄導致 AUC 增加 9 個百分點

2. **模型穩健性**：
   - 當 50-60% 的醫療紀錄被遮蔽時
   - AUC 僅下降約 1 個百分點
   - 展示其穩健性和對醫療紀錄交互作用的有效利用

#### 個人資訊重要性

**實驗方法**：
使用排列特徵重要性來評估各種個人資訊特徵對模型預測的影響。排列特徵導致的效能下降越大，該特徵對模型越重要。

**結果**（表 7）：

| 特徵 | Log Loss | AUC | AUC 下降 |
|------|----------|-----|----------|
| 無排列 | 0.2921 | 0.8908 | - |
| **年齡** | 0.3338 | **0.8364** | **-0.0544** |
| 性別 | 0.2931 | 0.8899 | -0.0009 |
| 偏遠地區 | 0.2922 | 0.8907 | -0.0001 |
| 居住地區 | 0.2937 | 0.8890 | -0.0018 |
| 職業 | 0.2924 | 0.8904 | -0.0004 |

**關鍵發現**：

1. **年齡是最重要的預測因子**：
   - 對模型預測影響最大
   - 與現有研究一致
   - 年齡是糖尿病、心臟病、中風和高血壓等慢性疾病的關鍵不可修改風險因子
   - 隨著年齡增長，各種生理功能下降，顯著增加發展這些病症的風險

2. **其他特徵的影響**：
   - 不會導致模型效能急劇下降
   - 觀察到性別和居住地區可能是潛在因子
   - 與文獻中的見解一致

### ICD 可解釋性：高注意力分數

**實驗方法**：
- 利用自注意力機制的注意力分數來解釋 ICD 代碼
- 選擇糖尿病、心臟病、中風和高血壓預測分數最高的前 2000 名患者
  - 這些可以被視為高置信度模型預測
- 識別這些患者中注意力分數最高的 ICD 代碼配對
- 突出模型認為最重要的特定 ICD 代碼之間的關係

**ICD 代碼分類（三組）**：

**1. 可修改風險因子**
- 純高膽固醇血症（272.0）
- 混合型高血脂（272.2）
- 其他和未明示高血脂（272.4）

**2. 多重慢性病**
- 痛風，未明示（274.9）
- 老年性白內障，未明示（366.10）
- 慢性肝炎，未明示（571.40）
- 慢性腎衰竭（585）
- 骨關節炎，局部性，未明示是原發性或繼發性，下肢（715.36）
- 骨關節炎，未明示是全身性或局部性，未明示部位（715.90）
- 腰薦椎脊椎病，無脊髓病變（721.3）

**3. 新興因子**
- 焦慮狀態，未明示（300.00）
- 神經性憂鬱（300.4）

---

## 討論 (Discussion)

### 主要貢獻

1. **證明 MTL 在同時預測糖尿病、心臟病、中風和高血壓方面的可行性**
2. **擴展先前研究開發的多模態模型能力**
   - 原先專注於失智症預測
   - 確認模型的有效性不限於單一疾病
   - 可以泛化到多種病症
   - 從單任務學習過渡到多任務學習

3. **突出 Word2Vec-based ICD 嵌入的重要性**
   - 透過將相關疾病分組同時使不相關疾病保持距離來細化特徵空間
   - 與缺乏語義意義的 label 編碼和 multi-hot 編碼不同
   - Word2Vec 嵌入學習疾病之間的關係
   - 導致更可分離和更有意義的特徵表示

### 效能分析

**MTL vs STL**：
- MTL 模型在預測四種慢性疾病方面的表現與 STL 模型相當
- 改進可能歸因於這些疾病之間的強相關性
- 它們經常作為彼此的風險因子
- 先前研究也支持慢性疾病之間存在多重慢性病
- 透過利用 MTL，有效捕捉跨任務的共享特徵，導致整體效能提升
- 儘管由於疾病特定差異而存在輕微效能變化
- 結果強調共享特徵的價值
- 暗示發現共同風險因子的潛力

### 模型穩健性

**特徵重要性實驗發現**：
- 即使遮蔽 60% 的 ICD 代碼
- 模型仍保持高 AUC 0.8825

**暗示**：
1. 存在大量有效特徵
2. 許多冗餘疾病出現在 ICD 代碼序列中
3. 關鍵風險因子在不同患者中是共同的

**結果**：
即使只有重要風險因子的子集可用，模型仍保持強大的預測效能，展示其韌性和適應性。

### 疾病相關性分析

**方法**：
透過選擇預測分數最高的前 2000 名患者，分析模型做出高置信度預測情況下的疾病相關性。

**識別的關鍵疾病**：

1. **已確立的可修改風險因子**（糖尿病、心臟病、中風和高血壓）
2. **慢性病**：
   - 痛風
   - 老年性白內障
   - 慢性肝炎
   - 老年人群中常見的慢性病症

**醫學證據**：
- 廣泛的醫學研究顯示患有慢性疾病的患者更有可能發展多重慢性病
- 解釋為什麼模型為這些病症分配更高的注意力分數

3. **新興風險因子**：
   - 焦慮和憂鬱
   - 新興研究暗示可能增加發展慢性疾病的可能性
   - 使它們成為進一步調查的潛在風險因子

### 模型準確率討論

**準確率範圍**：
- 模型的平衡準確率在四種疾病中從 60% 到 80% 不等

**結果仍然有意義的原因**：

1. **醫療 AI 的角色**：
   - 雖然準確率低於 90% 的模型可能不足以獨立診斷
   - 醫療 AI 系統通常設計用於支援臨床決策制定而非取代它
   - 即使未達到 90% 準確率，此類模型仍可為臨床醫生提供有價值的見解或解釋

2. **慢性疾病的複雜性**：
   - 考慮慢性疾病的複雜性
   - 存在許多隱藏的風險因子
   - 相信達到約 80% 準確率的模型仍可以幫助醫生在與臨床判斷結合使用時做出更明智的決策

### 研究限制

1. **依賴敏感醫療紀錄**：
   - 模型依賴患者的醫療紀錄
   - 敏感且可能在實際實施中帶來挑戰

2. **年齡依賴性**：
   - 實驗突出年齡作為重要預測因子
   - 需要進一步研究以識別年輕族群的關鍵風險因子以進行早期預防

3. **預測時間範圍**：
   - 使用患者過去 10 年的醫療紀錄預測未來 5 年的疾病發生率
   - 未來研究可以探索較短的醫療歷史（例如 5 年）是否預測長期疾病風險（例如 10 年）

4. **資料不平衡**：
   - 可能導致高假陰性率
   - 雖然保留原始資料分佈以避免破壞共病分析
   - 探索能夠有效解決 MTL 模型中不平衡的技術而不損害對疾病關係的洞察仍然有價值

### 未來研究方向

1. **簡化模型輸入**：
   - 潛在方法：模型蒸餾
   - 將所需的醫療紀錄減少到僅關鍵特徵
   - 使模型更適用於實際應用，如臨床決策支援

2. **年齡分層分析**：
   - 探索不同年齡組的風險因子
   - 提供更個人化的見解

3. **延伸至長期疾病預測**：
   - 能夠更早介入慢性病症

4. **解決資料不平衡**：
   - 由資料不平衡引起的高假陰性率可能透過以下技術緩解：
     - 採樣技術
     - 成本敏感學習

5. **預測年度疾病發生率**：
   - 以年度為基礎預測疾病發生率
   - 有助於識別加速疾病發生的風險因子

---

## 結論 (Conclusion)

建立在我們先前的研究基礎上，我們提出了多任務學習模型來同時預測多種慢性疾病。

**主要發現**：

1. **驗證模型可行性**：
   - 不僅驗證將先前模型應用於不同疾病的可行性
   - 也突出多任務學習在此領域的潛力

2. **MTL 與 STL 的可比效能**：
   - 暗示這些疾病之間存在共同風險因子

3. **模型韌性**：
   - 即使只有 40% 的醫療紀錄，模型也能保持強大效能
   - 展示其韌性和未來工作中知識蒸餾的潛力

4. **可解釋性**：
   - 具有高注意力分數的疾病與先前研究的發現一致
   - 進一步加強結果的可靠性

**未來展望**：
我們將這些方向留待未來研究。

---

## 資料可用性 (Data Availability)

當前研究期間分析的資料集不公開，因為它們是在台灣健康與福利資料科學中心的許可下用於當前研究；然而，在合理請求下可從通訊作者處獲得。

**收稿日期**：2025 年 2 月 12 日
**接受日期**：2025 年 4 月 21 日
**線上發布日期**：2025 年 5 月 3 日

---

## 關鍵術語解釋

- **STL (Single-Task Learning)**：單任務學習
- **MTL (Multi-Task Learning)**：多任務學習
- **ICD (International Classification of Diseases)**：國際疾病分類
- **MAND (Multimodal Attention Network for Dementia)**：失智症多模態注意力網路
- **CTR (Click-Through Rate)**：點擊率
- **AUC (Area Under the Curve)**：曲線下面積
- **BAC (Balanced Accuracy)**：平衡準確率
- **FPR (False Positive Rate)**：假陽性率
- **FNR (False Negative Rate)**：假陰性率
- **MHSA (Multi-Head Self-Attention)**：多頭自注意力機制
- **LSTM (Long Short-Term Memory)**：長短期記憶網路
- **MLP (Multi-Layer Perceptron)**：多層感知器
- **FM (Factorization Machine)**：因子分解機
- **DCN (Deep & Cross Network)**：深度交叉網路
