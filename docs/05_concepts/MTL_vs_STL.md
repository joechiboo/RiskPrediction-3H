# Multi-Task Learning vs Single-Task Learning

> **建立日期**：2026-01-08
> **用途**：論文 Motivation / Method 章節參考

---

## 核心概念：健檢哲學與機器學習的對應

### 健檢的基本精神

在實際健康檢查中，我們不可能「一次抽血只檢驗一個項目」。

**實務做法**：
- 抽一管血 → 同時檢驗血糖、血脂、肝功能、腎功能...
- 一次檢查 → 同時評估多種健康風險
- 這是**效率**與**整體觀**的體現

### 機器學習的對應

| 概念 | 健檢實務 | 機器學習方法 |
|------|----------|--------------|
| **低效率做法** | 抽三管血，分別送三個實驗室 | STL：建三個獨立模型 |
| **高效率做法** | 抽一管血，同時檢驗多項指標 | MTL：建一個模型，多個輸出 |

---

## STL（Single-Task Learning）

### 定義

為每個預測目標建立獨立的模型。

### 架構

```
輸入特徵 (X)
    │
    ├──► Model_HT ──► 高血壓預測 (y_HT)
    │
    ├──► Model_HG ──► 高血糖預測 (y_HG)
    │
    └──► Model_DL ──► 高血脂預測 (y_DL)
```

### 特點

| 項目 | 說明 |
|------|------|
| **模型數量** | 3 個獨立模型 |
| **訓練方式** | 各自訓練，互不影響 |
| **標籤使用** | 每個模型只看自己的 label |
| **疾病關聯** | ❌ 無法捕捉 |
| **類比** | 三個專科醫生，各看各的病歷 |

### 優點
- 實作簡單
- 每個模型可獨立優化
- 容易解釋單一疾病的風險因子

### 缺點
- 忽略疾病間的共病關係
- 重複學習共同特徵
- 訓練成本較高（3x）

---

## MTL（Multi-Task Learning）

### 定義

使用一個共享的模型架構，同時預測多個相關任務。

### 架構

```
輸入特徵 (X)
    │
    ▼
┌─────────────────┐
│  Shared Layers  │  ← 學習共同的健康風險表示
│  (特徵共享層)    │
└─────────────────┘
    │
    ├──► Head_HT ──► 高血壓預測 (y_HT)
    │
    ├──► Head_HG ──► 高血糖預測 (y_HG)
    │
    └──► Head_DL ──► 高血脂預測 (y_DL)
```

### 特點

| 項目 | 說明 |
|------|------|
| **模型數量** | 1 個共享模型 + 3 個輸出頭 |
| **訓練方式** | 聯合訓練，任務間互相影響 |
| **標籤使用** | 同時使用三種 label |
| **疾病關聯** | ✅ 能捕捉共病關係 |
| **類比** | 一個全科醫生，綜合判斷所有指標 |

### 優點
- 利用疾病間的相關性（三高共同風險因子）
- 共享特徵表示，提升學習效率
- 對小樣本任務有正則化效果
- 訓練成本較低

### 缺點
- 實作較複雜
- 任務間可能有負遷移（negative transfer）
- 需要平衡多個任務的損失函數

---

## 為什麼 MTL 適合三高預測？

### 1. 共同風險因子

三高（高血壓、高血糖、高血脂）有高度共病性，共享多個風險因子：

| 風險因子 | 高血壓 | 高血糖 | 高血脂 |
|----------|:------:|:------:|:------:|
| BMI | ✓ | ✓ | ✓ |
| 年齡 | ✓ | ✓ | ✓ |
| 尿酸 | ✓ | ✓ | ✓ |
| 腰圍 | ✓ | ✓ | ✓ |
| 家族史 | ✓ | ✓ | ✓ |

### 2. 代謝症候群

三高本質上是**代謝症候群**的組成部分，彼此高度相關：

```
代謝症候群 (Metabolic Syndrome)
├── 腹部肥胖
├── 高血壓 ←─┐
├── 高血糖 ←─┼── 互相影響
└── 高血脂 ←─┘
```

### 3. 臨床實務

- 醫生不會只看單一指標
- 健檢報告同時呈現多項數值
- 治療策略考慮整體代謝狀態

---

## 實驗設計：MTL vs STL 比較

### 實驗目標

驗證 MTL 是否能利用三高間的相關性，提升預測效能。

### 實驗組別

| 組別 | 方法 | 說明 |
|------|------|------|
| **STL** | 三個獨立 LR/RF/XGB | 基準線 |
| **MTL-A** | MultiOutputClassifier | sklearn 內建 |
| **MTL-B** | 共享隱藏層 + 3 輸出頭 | 神經網路架構 |
| **MTL-C** | Multi-label classification | 多標籤分類 |

### 評估指標

- 各疾病的 AUC
- 總體 macro-AUC
- 訓練時間比較
- 預測一致性（三高同時預測的合理性）

### 假說

> **H3**：同時預測三高（MTL）能利用疾病間的相關性，效能優於分別預測（STL）

預期結果：
- MTL 在整體效能上優於或持平 STL
- MTL 在資料量較少的疾病上表現更好（借用其他任務資訊）

---

## 論文撰寫建議

### Motivation 段落

> 健康檢查的核心精神是「一次抽血，多項篩檢」——透過單一血液樣本同時評估多種健康風險。這種整體觀的檢查方式不僅提升效率，更能捕捉不同健康指標之間的關聯。
>
> 同樣地，高血壓、高血糖、高血脂（俗稱「三高」）作為代謝症候群的核心組成，共享多個風險因子如 BMI、年齡、尿酸等。傳統的單任務學習（STL）為每種疾病建立獨立模型，忽略了這些疾病間的共病關係。
>
> 本研究採用多任務學習（MTL）架構，透過共享特徵表示層同時預測三種疾病，期望能捕捉三高之間的關聯性，提升整體預測效能。

### Method 段落

> 我們比較兩種學習策略：
>
> 1. **Single-Task Learning (STL)**：為高血壓、高血糖、高血脂分別建立獨立的預測模型
> 2. **Multi-Task Learning (MTL)**：使用共享的特徵表示層，同時預測三種疾病
>
> MTL 架構使用 [具體方法]，損失函數為三個任務的加權和...

---

## 參考文獻

1. Taiwan MTL (2025) - Multitask learning multimodal network for chronic disease prediction
   - DOI: 10.1038/s41598-025-99554-z
   - 同時預測糖尿病、心臟病、中風、高血壓

2. DHDIP (2022) - 高血壓與高血脂聯合預測
   - Multi-objective learning 方法

3. Caruana, R. (1997) - Multitask Learning
   - MTL 經典論文

---

## 相關檔案

- 假說列表：[hypothesis_list.md](../hypotheses/hypothesis_list.md) → H3
- 實驗筆記：待建立
- 參考文獻：[references/README.md](../references/README.md)
