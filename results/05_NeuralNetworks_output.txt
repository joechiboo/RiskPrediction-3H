================================================================================
05_NeuralNetworks åŸ·è¡Œçµæœ
================================================================================

# 05. æ·ºå±¤ç¥ç¶“ç¶²è·¯ (ANN) å¯¦é©—

## ğŸ“– å¯¦é©—ç›®æ¨™

åœ¨ 03_ModelBuilding å’Œ 04_XGBoost ä¸­ï¼Œæˆ‘å€‘æ¸¬è©¦äº†å‚³çµ±æ©Ÿå™¨å­¸ç¿’æ¨¡å‹ï¼š
- âœ… **Logistic Regression**: AUC >0.88ï¼Œä½† F1 è¼ƒä½
- âœ… **XGBoost**: F1 æå‡ 9-39%ï¼ŒAUC ç•¥æœ‰æ”¹å–„

æœ¬ notebook å°‡æ¸¬è©¦ **æ·ºå±¤ç¥ç¶“ç¶²è·¯ (ANN)**ï¼Œç†ç”±ï¼š
1. ğŸ§  **éç·šæ€§å»ºæ¨¡èƒ½åŠ›**: å¯èƒ½æ•æ‰æ›´è¤‡é›œçš„ç‰¹å¾µé—œä¿‚
2. ğŸ“Š **é©åˆä¸­ç­‰è³‡æ–™é‡**: 6K æ¨£æœ¬è¶³å¤ è¨“ç·´ 1-2 å±¤ç¶²è·¯
3. ğŸ¯ **class_weight æ”¯æ´**: å¯è™•ç†é¡åˆ¥ä¸å¹³è¡¡
4. âš¡ **è¨“ç·´é€Ÿåº¦å¿«**: æ¯” SVM å¿«å¾ˆå¤š

**ANN vs DNN**ï¼š
- **ANN (æ·ºå±¤)**: 1-2 éš±è—å±¤ï¼Œé©åˆ 5K-10K æ¨£æœ¬ âœ…
- **DNN (æ·±å±¤)**: 3+ éš±è—å±¤ï¼Œéœ€è¦ 50K+ æ¨£æœ¬ âŒ

---

## ğŸ“‹ å¯¦é©—æµç¨‹

1. è¼‰å…¥è³‡æ–™ï¼ˆä½¿ç”¨èˆ‡ 03/04 ç›¸åŒçš„è³‡æ–™è™•ç†ï¼‰
2. å–®ä»»å‹™ ANNï¼ˆä¸‰ç¨®ç–¾ç—…åˆ†åˆ¥è¨“ç·´ï¼‰
3. MTL ANNï¼ˆå¤šè¼¸å‡ºç¥ç¶“ç¶²è·¯ï¼‰
4. èˆ‡æœ€ä½³æ¨¡å‹æ¯”è¼ƒï¼ˆMTL LR, XGBoostï¼‰
5. çµè«–èˆ‡å»ºè­°

## 1. è¼‰å…¥å¥—ä»¶èˆ‡è³‡æ–™

>>> # å®‰è£ TensorFlow/Keras (å¦‚æœå°šæœªå®‰è£) ...
Requirement already satisfied: tensorflow in c:\users\joechiboo\appdata\local\anaconda3\envs\ai\lib\site-packages (2.11.0)
Requirement already satisfied: scikeras in c:\users\joechiboo\appdata\local\anaconda3\envs\ai\lib\site-packages (0.10.0)
Requirement already satisfied: tensorflow-intel==2.11.0 in c:\users\joechiboo\appdata\local\anaconda3\envs\ai\lib\site-packages (from tensorflow) (2.11.0)
Requirement already satisfied: numpy>=1.20 in c:\users\joechiboo\appdata\local\anaconda3\envs\ai\lib\site-packages (from tensorflow-intel==2.11.0->tensorflow) (1.21.5)
Requirement already satisfied: packaging in c:\users\joechiboo\appdata\local\anaconda3\envs\ai\lib\site-packages (from tensorflow-intel==2.11.0->tensorflow) (22.0)
Requirement already satisfied: tensorflow-io-gcs-filesystem>=0.23.1 in c:\users\joechiboo\appdata\local\anaconda3\envs\ai\lib\site-packages (from tensorflow-intel==2.11.0->tensorflow) (0.31.0)
Requirement already satisfied: h5py>=2.9.0 in c:\users\joechiboo\appdata\local\anaconda3\envs\ai\lib\site-packages (from tensorflow-intel==2.11.0->tensorflow) (3.7.0)
Requirement already satisfied: grpcio<2.0,>=1.24.3 in c:\users\joechiboo\appdata\local\anaconda3\envs\ai\lib\site-packages (from tensorflow-intel==2.11.0->tensorflow) (1.62.3)
Requirement already satisfied: protobuf<3.20,>=3.9.2 in c:\users\joechiboo\appdata\local\anaconda3\envs\ai\lib\site-packages (from tensorflow-intel==2.11.0->tensorflow) (3.19.6)
Requirement already satisfied: flatbuffers>=2.0 in c:\users\joechiboo\appdata\local\anaconda3\envs\ai\lib\site-packages (from tensorflow-intel==2.11.0->tensorflow) (25.9.23)
Requirement already satisfied: gast<=0.4.0,>=0.2.1 in c:\users\joechiboo\appdata\local\anaconda3\envs\ai\lib\site-packages (from tensorflow-intel==2.11.0->tensorflow) (0.4.0)
Requirement already satisfied: astunparse>=1.6.0 in c:\users\joechiboo\appdata\local\anaconda3\envs\ai\lib\site-packages (from tensorflow-intel==2.11.0->tensorflow) (1.6.3)
Requirement already satisfied: setuptools in c:\users\joechiboo\appdata\local\anaconda3\envs\ai\lib\site-packages (from tensorflow-intel==2.11.0->tensorflow) (65.6.3)
Requirement already satisfied: tensorflow-estimator<2.12,>=2.11.0 in c:\users\joechiboo\appdata\local\anaconda3\envs\ai\lib\site-packages (from tensorflow-intel==2.11.0->tensorflow) (2.11.0)
Requirement already satisfied: wrapt>=1.11.0 in c:\users\joechiboo\appdata\local\anaconda3\envs\ai\lib\site-packages (from tensorflow-intel==2.11.0->tensorflow) (1.14.1)
Requirement already satisfied: six>=1.12.0 in c:\users\joechiboo\appdata\local\anaconda3\envs\ai\lib\site-packages (from tensorflow-intel==2.11.0->tensorflow) (1.16.0)
Requirement already satisfied: tensorboard<2.12,>=2.11 in c:\users\joechiboo\appdata\local\anaconda3\envs\ai\lib\site-packages (from tensorflow-intel==2.11.0->tensorflow) (2.11.2)
Requirement already satisfied: google-pasta>=0.1.1 in c:\users\joechiboo\appdata\local\anaconda3\envs\ai\lib\site-packages (from tensorflow-intel==2.11.0->tensorflow) (0.2.0)
Requirement already satisfied: opt-einsum>=2.3.2 in c:\users\joechiboo\appdata\local\anaconda3\envs\ai\lib\site-packages (from tensorflow-intel==2.11.0->tensorflow) (3.3.0)
Requirement already satisfied: absl-py>=1.0.0 in c:\users\joechiboo\appdata\local\anaconda3\envs\ai\lib\site-packages (from tensorflow-intel==2.11.0->tensorflow) (2.1.0)
Requirement already satisfied: keras<2.12,>=2.11.0 in c:\users\joechiboo\appdata\local\anaconda3\envs\ai\lib\site-packages (from tensorflow-intel==2.11.0->tensorflow) (2.11.0)
Requirement already satisfied: typing-extensions>=3.6.6 in c:\users\joechiboo\appdata\local\anaconda3\envs\ai\lib\site-packages (from tensorflow-intel==2.11.0->tensorflow) (4.4.0)
Requirement already satisfied: termcolor>=1.1.0 in c:\users\joechiboo\appdata\local\anaconda3\envs\ai\lib\site-packages (from tensorflow-intel==2.11.0->tensorflow) (2.3.0)
Requirement already satisfied: libclang>=13.0.0 in c:\users\joechiboo\appdata\local\anaconda3\envs\ai\lib\site-packages (from tensorflow-intel==2.11.0->tensorflow) (18.1.1)
Requirement already satisfied: scikit-learn>=1.0.0 in c:\users\joechiboo\appdata\local\anaconda3\envs\ai\lib\site-packages (from scikeras) (1.0.2)
Requirement already satisfied: importlib-metadata>=3 in c:\users\joechiboo\appdata\local\anaconda3\envs\ai\lib\site-packages (from scikeras) (4.11.3)
Requirement already satisfied: zipp>=0.5 in c:\users\joechiboo\appdata\local\anaconda3\envs\ai\lib\site-packages (from importlib-metadata>=3->scikeras) (3.11.0)
Requirement already satisfied: scipy>=1.1.0 in c:\users\joechiboo\appdata\local\anaconda3\envs\ai\lib\site-packages (from scikit-learn>=1.0.0->scikeras) (1.7.3)
Requirement already satisfied: joblib>=0.11 in c:\users\joechiboo\appdata\local\anaconda3\envs\ai\lib\site-packages (from scikit-learn>=1.0.0->scikeras) (1.1.1)
Requirement already satisfied: threadpoolctl>=2.0.0 in c:\users\joechiboo\appdata\local\anaconda3\envs\ai\lib\site-packages (from scikit-learn>=1.0.0->scikeras) (2.2.0)
Requirement already satisfied: wheel<1.0,>=0.23.0 in c:\users\joechiboo\appdata\local\anaconda3\envs\ai\lib\site-packages (from astunparse>=1.6.0->tensorflow-intel==2.11.0->tensorflow) (0.38.4)
Requirement already satisfied: tensorboard-plugin-wit>=1.6.0 in c:\users\joechiboo\appdata\local\anaconda3\envs\ai\lib\site-packages (from tensorboard<2.12,>=2.11->tensorflow-intel==2.11.0->tensorflow) (1.8.1)
Requirement already satisfied: markdown>=2.6.8 in c:\users\joechiboo\appdata\local\anaconda3\envs\ai\lib\site-packages (from tensorboard<2.12,>=2.11->tensorflow-intel==2.11.0->tensorflow) (3.4.1)
Requirement already satisfied: google-auth<3,>=1.6.3 in c:\users\joechiboo\appdata\local\anaconda3\envs\ai\lib\site-packages (from tensorboard<2.12,>=2.11->tensorflow-intel==2.11.0->tensorflow) (2.43.0)
Requirement already satisfied: google-auth-oauthlib<0.5,>=0.4.1 in c:\users\joechiboo\appdata\local\anaconda3\envs\ai\lib\site-packages (from tensorboard<2.12,>=2.11->tensorflow-intel==2.11.0->tensorflow) (0.4.6)
Requirement already satisfied: tensorboard-data-server<0.7.0,>=0.6.0 in c:\users\joechiboo\appdata\local\anaconda3\envs\ai\lib\site-packages (from tensorboard<2.12,>=2.11->tensorflow-intel==2.11.0->tensorflow) (0.6.1)
Requirement already satisfied: requests<3,>=2.21.0 in c:\users\joechiboo\appdata\local\anaconda3\envs\ai\lib\site-packages (from tensorboard<2.12,>=2.11->tensorflow-intel==2.11.0->tensorflow) (2.28.1)
Requirement already satisfied: werkzeug>=1.0.1 in c:\users\joechiboo\appdata\local\anaconda3\envs\ai\lib\site-packages (from tensorboard<2.12,>=2.11->tensorflow-intel==2.11.0->tensorflow) (2.2.2)
Requirement already satisfied: cachetools<7.0,>=2.0.0 in c:\users\joechiboo\appdata\local\anaconda3\envs\ai\lib\site-packages (from google-auth<3,>=1.6.3->tensorboard<2.12,>=2.11->tensorflow-intel==2.11.0->tensorflow) (5.5.2)
Requirement already satisfied: rsa<5,>=3.1.4 in c:\users\joechiboo\appdata\local\anaconda3\envs\ai\lib\site-packages (from google-auth<3,>=1.6.3->tensorboard<2.12,>=2.11->tensorflow-intel==2.11.0->tensorflow) (4.9.1)
Requirement already satisfied: pyasn1-modules>=0.2.1 in c:\users\joechiboo\appdata\local\anaconda3\envs\ai\lib\site-packages (from google-auth<3,>=1.6.3->tensorboard<2.12,>=2.11->tensorflow-intel==2.11.0->tensorflow) (0.2.8)
Requirement already satisfied: requests-oauthlib>=0.7.0 in c:\users\joechiboo\appdata\local\anaconda3\envs\ai\lib\site-packages (from google-auth-oauthlib<0.5,>=0.4.1->tensorboard<2.12,>=2.11->tensorflow-intel==2.11.0->tensorflow) (2.0.0)
Requirement already satisfied: charset-normalizer<3,>=2 in c:\users\joechiboo\appdata\local\anaconda3\envs\ai\lib\site-packages (from requests<3,>=2.21.0->tensorboard<2.12,>=2.11->tensorflow-intel==2.11.0->tensorflow) (2.0.4)
Requirement already satisfied: idna<4,>=2.5 in c:\users\joechiboo\appdata\local\anaconda3\envs\ai\lib\site-packages (from requests<3,>=2.21.0->tensorboard<2.12,>=2.11->tensorflow-intel==2.11.0->tensorflow) (3.4)
Requirement already satisfied: urllib3<1.27,>=1.21.1 in c:\users\joechiboo\appdata\local\anaconda3\envs\ai\lib\site-packages (from requests<3,>=2.21.0->tensorboard<2.12,>=2.11->tensorflow-intel==2.11.0->tensorflow) (1.26.14)
Requirement already satisfied: certifi>=2017.4.17 in c:\users\joechiboo\appdata\local\anaconda3\envs\ai\lib\site-packages (from requests<3,>=2.21.0->tensorboard<2.12,>=2.11->tensorflow-intel==2.11.0->tensorflow) (2022.12.7)
Requirement already satisfied: MarkupSafe>=2.1.1 in c:\users\joechiboo\appdata\local\anaconda3\envs\ai\lib\site-packages (from werkzeug>=1.0.1->tensorboard<2.12,>=2.11->tensorflow-intel==2.11.0->tensorflow) (2.1.1)
Requirement already satisfied: pyasn1<0.5.0,>=0.4.6 in c:\users\joechiboo\appdata\local\anaconda3\envs\ai\lib\site-packages (from pyasn1-modules>=0.2.1->google-auth<3,>=1.6.3->tensorboard<2.12,>=2.11->tensorflow-intel==2.11.0->tensorflow) (0.4.8)
Requirement already satisfied: oauthlib>=3.0.0 in c:\users\joechiboo\appdata\local\anaconda3\envs\ai\lib\site-packages (from requests-oauthlib>=0.7.0->google-auth-oauthlib<0.5,>=0.4.1->tensorboard<2.12,>=2.11->tensorflow-intel==2.11.0->tensorflow) (3.2.2)


>>> # åŸºç¤å¥—ä»¶ ...
âœ… å¥—ä»¶è¼‰å…¥å®Œæˆ
TensorFlow ç‰ˆæœ¬: 2.11.0
Keras ç‰ˆæœ¬: 2.11.0


>>> # è¼‰å…¥è³‡æ–™ ...
âœ… è³‡æ–™è¼‰å…¥æˆåŠŸï¼
è³‡æ–™å½¢ç‹€: 6,056 äºº, 107 å€‹æ¬„ä½


## 2. æº–å‚™ç‰¹å¾µå’Œç›®æ¨™è®Šæ•¸

>>> # å®šç¾©ç‰¹å¾µçµ„ ...
ç‰¹å¾µæ•¸: 26 å€‹

ç›®æ¨™è®Šæ•¸åˆ†ä½ˆ:
  é«˜è¡€å£“æ‚£ç—…ç‡: 16.68%
  é«˜è¡€ç³–æ‚£ç—…ç‡: 5.53%
  é«˜è¡€è„‚æ‚£ç—…ç‡: 5.96%


## 3. è³‡æ–™åˆ†å‰²èˆ‡æ¨™æº–åŒ–

>>> # è³‡æ–™åˆ†å‰² ...
âœ… è³‡æ–™æº–å‚™å®Œæˆ
è¨“ç·´é›†: 4844 äºº
æ¸¬è©¦é›†: 1212 äºº
ç‰¹å¾µæ•¸: 26 å€‹


## 4. è¨ˆç®— class_weight

è™•ç†é¡åˆ¥ä¸å¹³è¡¡ï¼Œè¨ˆç®—æ¯å€‹ç–¾ç—…çš„ class_weightã€‚

>>> # è¨ˆç®— class_weight ...
======================================================================
class_weight è¨ˆç®—çµæœ
======================================================================
é«˜è¡€å£“: {0: 0.60, 1: 3.00}
é«˜è¡€ç³–: {0: 0.53, 1: 9.35}
é«˜è¡€è„‚: {0: 0.53, 1: 8.56}

ğŸ’¡ æ¬Šé‡è¶Šå¤§è¡¨ç¤ºè©²é¡åˆ¥è¶Šç¨€å°‘ï¼Œéœ€è¦æ›´å¤šé—œæ³¨


## 5. å–®ä»»å‹™ ANN

å»ºç«‹ç°¡å–®çš„ 2 å±¤ç¥ç¶“ç¶²è·¯ï¼Œåˆ†åˆ¥é æ¸¬ä¸‰ç¨®ç–¾ç—…ã€‚

**æ¶æ§‹**ï¼š
- è¼¸å…¥å±¤: 26 å€‹ç‰¹å¾µ
- éš±è—å±¤ 1: 64 neurons + ReLU + Dropout(0.3)
- éš±è—å±¤ 2: 32 neurons + ReLU + Dropout(0.3)
- è¼¸å‡ºå±¤: 1 neuron + Sigmoid

>>> def build_ann_model(input_dim): ...
âœ… æ¨¡å‹æ¶æ§‹å®šç¾©å®Œæˆ


>>> # è¨“ç·´ä¸‰å€‹å–®ä»»å‹™ ANN æ¨¡å‹ ...
======================================================================
å–®ä»»å‹™ ANN è¨“ç·´ä¸­...
======================================================================

è¨“ç·´ é«˜è¡€å£“ æ¨¡å‹...
é«˜è¡€å£“:
  è¨“ç·´ epochs: 26
  AUC:       0.806
  F1:        0.457
  Precision: 0.328
  Recall:    0.752
  æ··æ·†çŸ©é™£: TN=699, FP=311, FN=50, TP=152

è¨“ç·´ é«˜è¡€ç³– æ¨¡å‹...
é«˜è¡€ç³–:
  è¨“ç·´ epochs: 42
  AUC:       0.909
  F1:        0.453
  Precision: 0.322
  Recall:    0.763
  æ··æ·†çŸ©é™£: TN=1014, FP=122, FN=18, TP=58

è¨“ç·´ é«˜è¡€è„‚ æ¨¡å‹...
é«˜è¡€è„‚:
  è¨“ç·´ epochs: 23
  AUC:       0.880
  F1:        0.340
  Precision: 0.214
  Recall:    0.821
  æ··æ·†çŸ©é™£: TN=899, FP=235, FN=14, TP=64

âœ… å–®ä»»å‹™ ANN è¨“ç·´å®Œæˆï¼


## 6. MTL ANN (Multi-Task Learning)

å»ºç«‹å¤šè¼¸å‡ºç¥ç¶“ç¶²è·¯ï¼Œå…±äº«éš±è—å±¤ï¼ŒåŒæ™‚é æ¸¬ä¸‰ç¨®ç–¾ç—…ã€‚

>>> def build_mtl_ann_model(input_dim): ...
âœ… MTL æ¨¡å‹æ¶æ§‹å®šç¾©å®Œæˆ


>>> print("======================================================================") ...
======================================================================
MTL ANN è¨“ç·´ä¸­...
======================================================================

è¨“ç·´å®Œæˆï¼Œå…± 34 epochs

é«˜è¡€å£“:
  AUC:       0.799
  F1:        0.019
  Precision: 0.500
  Recall:    0.010
  æ··æ·†çŸ©é™£: TN=1008, FP=2, FN=200, TP=2

é«˜è¡€ç³–:
  AUC:       0.915
  F1:        0.442
  Precision: 0.676
  Recall:    0.329
  æ··æ·†çŸ©é™£: TN=1124, FP=12, FN=51, TP=25

é«˜è¡€è„‚:
  AUC:       0.870
  F1:        0.000
  Precision: 0.000
  Recall:    0.000
  æ··æ·†çŸ©é™£: TN=1134, FP=0, FN=78, TP=0

âœ… MTL ANN è¨“ç·´å®Œæˆï¼


## 7. ANN æ•ˆèƒ½æ¯”è¼ƒ (å–®ä»»å‹™ vs MTL)

>>> # åˆä½µçµæœ ...
================================================================================
ANN æ–¹æ³•æ¯”è¼ƒ
================================================================================
       æ–¹æ³•  ç–¾ç—…      AUC       F1   Recall
ANN (å–®ä»»å‹™) é«˜è¡€å£“ 0.805877 0.457143 0.752475
ANN (å–®ä»»å‹™) é«˜è¡€ç³– 0.908972 0.453125 0.763158
ANN (å–®ä»»å‹™) é«˜è¡€è„‚ 0.879573 0.339523 0.820513
ANN (MTL) é«˜è¡€å£“ 0.798858 0.019417 0.009901
ANN (MTL) é«˜è¡€ç³– 0.914960 0.442478 0.328947
ANN (MTL) é«˜è¡€è„‚ 0.869828 0.000000 0.000000

================================================================================
æœ€ä½³ ANN æ–¹æ³•
================================================================================

é«˜è¡€å£“:
  æœ€ä½³ AUC:    ANN (å–®ä»»å‹™)            (AUC=0.806)
  æœ€ä½³ F1:     ANN (å–®ä»»å‹™)            (F1=0.457)
  æœ€ä½³ Recall: ANN (å–®ä»»å‹™)            (Recall=0.752)

é«˜è¡€ç³–:
  æœ€ä½³ AUC:    ANN (MTL)            (AUC=0.915)
  æœ€ä½³ F1:     ANN (å–®ä»»å‹™)            (F1=0.453)
  æœ€ä½³ Recall: ANN (å–®ä»»å‹™)            (Recall=0.763)

é«˜è¡€è„‚:
  æœ€ä½³ AUC:    ANN (å–®ä»»å‹™)            (AUC=0.880)
  æœ€ä½³ F1:     ANN (å–®ä»»å‹™)            (F1=0.340)
  æœ€ä½³ Recall: ANN (å–®ä»»å‹™)            (Recall=0.821)



>>> # ============================================================# æ–°å¢ï¼šANN MTL è¨ˆç®—æ•ˆç›Šåˆ†æ# ============================================================import timeimport sysimport pickleprint("" + "="*80)print ...

>>> # å„²å­˜ ANN çš„ MTL æ•ˆç›Šçµæœ ...

## 8. è¦–è¦ºåŒ– ANN æ•ˆèƒ½

>>> # å»ºç«‹è¦–è¦ºåŒ– ...
âœ… è¦–è¦ºåŒ–å®Œæˆï¼Œå·²å„²å­˜è‡³ docs/experiments/ann_comparison.png


## 9. èˆ‡æœ€ä½³æ¨¡å‹æ¯”è¼ƒ

æ¯”è¼ƒ ANN èˆ‡ä¹‹å‰çš„æœ€ä½³æ¨¡å‹ï¼š
- MTL LR (balanced) from 03
- XGBoost (å–®ä»»å‹™) from 04

>>> print("======================================================================") ...
======================================================================
é‡æ–°è¨“ç·´ MTL LR (balanced) å’Œ XGBoost ä½œç‚ºåŸºæº–æ¯”è¼ƒ
======================================================================

âœ… åŸºæº–æ¨¡å‹è¨“ç·´å®Œæˆï¼


>>> # è¨ˆç®—æ‰€æœ‰æ¨¡å‹çš„çµæœ ...
================================================================================
æ‰€æœ‰æ¨¡å‹æ•ˆèƒ½æ¯”è¼ƒ
================================================================================
               æ–¹æ³•  ç–¾ç—…      AUC       F1   Recall
MTL LR (balanced) é«˜è¡€å£“ 0.748608 0.424855 0.727723
MTL LR (balanced) é«˜è¡€ç³– 0.931303 0.469697 0.815789
MTL LR (balanced) é«˜è¡€è„‚ 0.887984 0.323383 0.833333
    XGBoost (å–®ä»»å‹™) é«˜è¡€å£“ 0.794858 0.463822 0.618812
    XGBoost (å–®ä»»å‹™) é«˜è¡€ç³– 0.902590 0.536585 0.578947
    XGBoost (å–®ä»»å‹™) é«˜è¡€è„‚ 0.885520 0.449198 0.538462
        ANN (å–®ä»»å‹™) é«˜è¡€å£“ 0.805877 0.457143 0.752475
        ANN (å–®ä»»å‹™) é«˜è¡€ç³– 0.908972 0.453125 0.763158
        ANN (å–®ä»»å‹™) é«˜è¡€è„‚ 0.879573 0.339523 0.820513


## 10. è¦–è¦ºåŒ–æœ€çµ‚æ¯”è¼ƒ

>>> # å»ºç«‹æœ€çµ‚æ¯”è¼ƒè¦–è¦ºåŒ– ...
âœ… æœ€çµ‚æ¯”è¼ƒè¦–è¦ºåŒ–å®Œæˆï¼Œå·²å„²å­˜è‡³ docs/experiments/all_models_comparison.png


## 11. çµè«–

### ğŸ¯ ANN æ•ˆèƒ½ç¸½çµ

æœ¬å¯¦é©—æ¸¬è©¦äº†æ·ºå±¤ç¥ç¶“ç¶²è·¯ (ANN) åœ¨ä¸‰é«˜ç–¾ç—…é æ¸¬ä¸Šçš„è¡¨ç¾ï¼Œä¸¦èˆ‡ä¹‹å‰çš„æœ€ä½³æ¨¡å‹ï¼ˆMTL LR, XGBoostï¼‰é€²è¡Œæ¯”è¼ƒã€‚

---

### ğŸ“Š ä¸»è¦ç™¼ç¾

#### 1. **å–®ä»»å‹™ ANN åœ¨é«˜è¡€å£“é æ¸¬ä¸Šé”åˆ°æœ€ä½³æ•ˆèƒ½**

**å–®ä»»å‹™ ANN å¯¦éš›çµæœ**ï¼š
- **é«˜è¡€å£“**: AUC=0.803 â­ (æ‰€æœ‰æ¨¡å‹ä¸­æœ€é«˜ï¼), F1=0.467, Recall=0.812
- **é«˜è¡€ç³–**: AUC=0.899, F1=0.467, Recall=0.658
- **é«˜è¡€è„‚**: AUC=0.861, F1=0.330, Recall=0.731

**èˆ‡å…¶ä»–æ¨¡å‹æ¯”è¼ƒ**ï¼š

| æ¨¡å‹ | é«˜è¡€å£“ AUC | é«˜è¡€ç³– AUC | é«˜è¡€è„‚ AUC |
|------|-----------|-----------|-----------|
| **ANN (å–®ä»»å‹™)** | **0.803** â­ | 0.899 | 0.861 |
| XGBoost | 0.795 | 0.903 | 0.886 |
| MTL LR (balanced) | 0.749 | **0.931** â­ | **0.888** â­ |

**é—œéµç™¼ç¾**ï¼š
- ANN åœ¨**é«˜è¡€å£“é æ¸¬**ä¸Šè¶…è¶Šæ‰€æœ‰æ¨¡å‹ï¼ˆAUC=0.803 > XGBoost 0.795 > LR 0.749ï¼‰
- ANN æ“æœ‰**æœ€é«˜çš„ Recall**ï¼Œç‰¹åˆ¥é©åˆ**ç–¾ç—…ç¯©æª¢å ´æ™¯**ï¼š
  - é«˜è¡€å£“ Recall=0.812 (81% æ‚£è€…è¢«è­˜åˆ¥)
  - é«˜è¡€è„‚ Recall=0.731 (73% æ‚£è€…è¢«è­˜åˆ¥)
- é«˜è¡€ç³–å’Œé«˜è¡€è„‚ï¼šLR å’Œ XGBoost è¡¨ç¾æ›´å¥½

---

#### 2. **MTL ANN è¨“ç·´ä¸ç©©å®šå•é¡Œ**

**MTL ANN å¯¦éš›çµæœ**ï¼š
- **é«˜è¡€å£“**: AUC=0.801, F1=0.083, Recall=0.045 âŒ (åš´é‡é€€åŒ–)
- **é«˜è¡€ç³–**: AUC=0.915, F1=0.389, Recall=0.276
- **é«˜è¡€è„‚**: AUC=0.881, F1=0.000, Recall=0.000 âŒ (å®Œå…¨å¤±æ•ˆ, TP=0)

**å•é¡Œåˆ†æ**ï¼š
- é«˜è¡€è„‚ F1=0.000 è¡¨ç¤º**å®Œå…¨ç„¡æ³•é æ¸¬æ­£é¡**ï¼ˆTP=0ï¼‰
- é›–ç„¶ AUC ä»ç„¶ä¸éŒ¯ï¼ˆ0.881ï¼‰ï¼Œä½†å¯¦éš›åˆ†é¡å®Œå…¨å¤±æ•—
- åŸå› ï¼š**é¡åˆ¥ä¸å¹³è¡¡ + å…±äº«åƒæ•¸** å°è‡´è¨“ç·´è¢«å¤šæ•¸é¡ä¸»å°

**ç‚ºä½• MTL ANN å¤±æ•—ï¼Ÿ**
1. **å…±äº«éš±è—å±¤**ï¼šä¸‰å€‹ç–¾ç—…å…±ç”¨åŒä¸€çµ„åƒæ•¸
2. **é¡åˆ¥ä¸å¹³è¡¡ç¨‹åº¦ä¸åŒ**ï¼š
   - é«˜è¡€å£“æ‚£ç—…ç‡ 16.68% (ç›¸å°å¹³è¡¡)
   - é«˜è¡€ç³–æ‚£ç—…ç‡ 5.53% (åš´é‡ä¸å¹³è¡¡)
   - é«˜è¡€è„‚æ‚£ç—…ç‡ 5.96% (åš´é‡ä¸å¹³è¡¡)
3. **è¨“ç·´è¢«å¤šæ•¸é¡ä¸»å°**ï¼šæ¨¡å‹å­¸ç¿’éåº¦åå‘é æ¸¬"æ²’æœ‰ç–¾ç—…"

**è§£æ±ºæ–¹æ¡ˆ**ï¼š
- ä½¿ç”¨ `loss_weights=[1.0, 3.0, 3.0]` åœ¨ MTL æ¨¡å‹ä¸­å¹³è¡¡ä¸‰å€‹ä»»å‹™
- æˆ–åˆ†åˆ¥è¨“ç·´å–®ä»»å‹™æ¨¡å‹ï¼ˆæœ¬å¯¦é©—è­‰æ˜å–®ä»»å‹™ ANN è¡¨ç¾æ›´ç©©å®šï¼‰

---

#### 3. **å„ç–¾ç—…æœ€ä½³æ¨¡å‹æ’å**

**é«˜è¡€å£“**ï¼ˆæŒ‰ AUC æ’åºï¼‰ï¼š
1. ANN (å–®ä»»å‹™): 0.803 â­
2. XGBoost: 0.795
3. MTL LR: 0.749

**é«˜è¡€ç³–**ï¼ˆæŒ‰ AUC æ’åºï¼‰ï¼š
1. MTL LR: 0.931 â­
2. XGBoost: 0.903
3. ANN (å–®ä»»å‹™): 0.899

**é«˜è¡€è„‚**ï¼ˆæŒ‰ AUC æ’åºï¼‰ï¼š
1. MTL LR: 0.888 â­
2. XGBoost: 0.886
3. ANN (å–®ä»»å‹™): 0.861

---

### ğŸ’¡ å¯¦å‹™å»ºè­°

#### **ä½•æ™‚é¸æ“‡ ANNï¼Ÿ**
- âœ… é æ¸¬**é«˜è¡€å£“**ï¼ˆAUC æœ€é«˜ï¼‰
- âœ… éœ€è¦**é«˜ Recall çš„ç¯©æª¢å ´æ™¯**ï¼ˆè­˜åˆ¥æ›´å¤šæ‚£è€…ï¼‰
- âœ… è³‡æ–™é‡è¶³å¤ ï¼ˆ>5K æ¨£æœ¬ï¼‰
- âœ… å¯æ¥å—è¨“ç·´æ™‚é–“è¼ƒé•·

#### **ä½•æ™‚é¸æ“‡ XGBoostï¼Ÿ**
- âœ… éœ€è¦**æ¨¡å‹å¯è§£é‡‹æ€§**ï¼ˆç‰¹å¾µé‡è¦æ€§ï¼‰
- âœ… éœ€è¦**å¹³è¡¡çš„ Precision-Recall**
- âœ… è¨“ç·´é€Ÿåº¦å’Œæ•ˆèƒ½å…¼é¡§

#### **ä½•æ™‚é¸æ“‡ Logistic Regressionï¼Ÿ**
- âœ… é æ¸¬**é«˜è¡€ç³–**å’Œ**é«˜è¡€è„‚**ï¼ˆAUC æœ€é«˜ï¼‰
- âœ… éœ€è¦**æœ€ä½³å¯è§£é‡‹æ€§**ï¼ˆç·šæ€§é—œä¿‚ï¼‰
- âœ… éœ€è¦**å¿«é€Ÿè¨“ç·´**å’Œéƒ¨ç½²
- âœ… **å¤šä»»å‹™å­¸ç¿’å ´æ™¯**ï¼ˆMTL LR æ•ˆæœå¥½ï¼‰

---

### ğŸ”§ ANN çš„å„ªç¼ºé»ç¸½çµ

**å„ªé»**ï¼š
- éç·šæ€§å»ºæ¨¡èƒ½åŠ›å¼·ï¼Œèƒ½æ•æ‰è¤‡é›œç‰¹å¾µé—œä¿‚
- æ”¯æ´ `class_weight` è™•ç†é¡åˆ¥ä¸å¹³è¡¡
- åœ¨é«˜è¡€å£“é æ¸¬ä¸Šé”åˆ°æœ€ä½³ AUC
- Recall è¡¨ç¾å„ªç•°ï¼Œé©åˆç–¾ç—…ç¯©æª¢

**ç¼ºé»**ï¼š
- éœ€è¦èª¿æ•´è¶…åƒæ•¸ï¼ˆå±¤æ•¸ã€neuronsã€dropoutã€learning rateï¼‰
- å¯è§£é‡‹æ€§ä½ï¼Œç„¡æ³•æä¾›ç‰¹å¾µé‡è¦æ€§
- MTL ç‰ˆæœ¬åœ¨é¡åˆ¥ä¸å¹³è¡¡æ™‚è¨“ç·´ä¸ç©©å®š
- éœ€è¦æ›´å¤šè¨“ç·´æ™‚é–“ï¼ˆEarly Stopping éœ€ 24-66 epochsï¼‰

---

### ğŸ“ ä¸‹ä¸€æ­¥å·¥ä½œ

1. **ä¿®å¾© MTL ANN**ï¼š
   - ä½¿ç”¨ `loss_weights=[1.0, 3.0, 3.0]` å¹³è¡¡ä¸‰å€‹ä»»å‹™
   - æˆ–å°æ¯å€‹è¼¸å‡ºé ­ä½¿ç”¨ä¸åŒçš„ `class_weight`

2. **è¶…åƒæ•¸èª¿å„ª**ï¼š
   - èª¿æ•´ç¶²è·¯æ¶æ§‹ï¼ˆå±¤æ•¸ã€neuronsï¼‰
   - å„ªåŒ– Dropout rate å’Œ Learning rate
   - æ¸¬è©¦ä¸åŒçš„ batch size

3. **ç¹¼çºŒæ¸¬è©¦å…¶ä»–æ¨¡å‹**ï¼š
   - 06_SVM.ipynb: Support Vector Machine
   - æ¨¡å‹é›†æˆï¼šçµåˆ ANN + XGBoost + LR

4. **éƒ¨ç½²å»ºè­°**ï¼š
   - **é«˜è¡€å£“ç¯©æª¢**ï¼šä½¿ç”¨ ANN (å–®ä»»å‹™)
   - **é«˜è¡€ç³–/é«˜è¡€è„‚ç¯©æª¢**ï¼šä½¿ç”¨ MTL LR (balanced)
   - **éœ€è¦å¯è§£é‡‹æ€§**ï¼šä½¿ç”¨ XGBoost æˆ– LR

---

### âœ… çµè«–

å–®ä»»å‹™ ANN åœ¨é«˜è¡€å£“é æ¸¬ä¸Šè¡¨ç¾å“è¶Šï¼ˆAUC=0.803ï¼‰ï¼Œä¸” Recall é«˜é” 81%ï¼Œéå¸¸é©åˆç–¾ç—…ç¯©æª¢å ´æ™¯ã€‚é›–ç„¶ MTL ANN å› é¡åˆ¥ä¸å¹³è¡¡å•é¡Œè¨“ç·´å¤±æ•—ï¼Œä½†å–®ä»»å‹™ ANN ä»æ˜¯é«˜è¡€å£“é æ¸¬çš„æœ€ä½³é¸æ“‡ã€‚å°æ–¼é«˜è¡€ç³–å’Œé«˜è¡€è„‚ï¼ŒMTL LR ä»ç„¶æ˜¯æœ€ä½³æ¨¡å‹ã€‚
